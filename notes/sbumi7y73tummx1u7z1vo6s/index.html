<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><link rel="icon" href="/dendron-wiki/favicon.ico"/><title>SQL</title><meta name="robots" content="index,follow"/><meta name="googlebot" content="index,follow"/><meta name="description" content="Personal knowledge space"/><meta property="og:title" content="SQL"/><meta property="og:description" content="Personal knowledge space"/><meta property="og:url" content="https://ngocuong0105.github.io/dendron-wiki/notes/sbumi7y73tummx1u7z1vo6s/"/><meta property="og:type" content="article"/><meta property="article:published_time" content="7/24/2022"/><meta property="article:modified_time" content="6/10/2025"/><link rel="canonical" href="https://ngocuong0105.github.io/dendron-wiki/notes/sbumi7y73tummx1u7z1vo6s/"/><meta name="next-head-count" content="14"/><link rel="preload" href="/dendron-wiki/_next/static/css/73bff7fc08ed1d26.css" as="style"/><link rel="stylesheet" href="/dendron-wiki/_next/static/css/73bff7fc08ed1d26.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/dendron-wiki/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/dendron-wiki/_next/static/chunks/webpack-5a49f804ab2869ab.js" defer=""></script><script src="/dendron-wiki/_next/static/chunks/framework-28c999baf2863c3d.js" defer=""></script><script src="/dendron-wiki/_next/static/chunks/main-2a75a40d33729b12.js" defer=""></script><script src="/dendron-wiki/_next/static/chunks/pages/_app-28855ac016325484.js" defer=""></script><script src="/dendron-wiki/_next/static/chunks/935-4dee79e80b8641c6.js" defer=""></script><script src="/dendron-wiki/_next/static/chunks/6-50972def09142ee2.js" defer=""></script><script src="/dendron-wiki/_next/static/chunks/pages/notes/%5Bid%5D-78d472fa3b924116.js" defer=""></script><script src="/dendron-wiki/_next/static/hUMuUtBSCkU7YSeQn-rle/_buildManifest.js" defer=""></script><script src="/dendron-wiki/_next/static/hUMuUtBSCkU7YSeQn-rle/_ssgManifest.js" defer=""></script></head><body><div id="__next" data-reactroot=""><section class="ant-layout" style="width:100%;min-height:100%"><header class="ant-layout-header" style="position:fixed;isolation:isolate;z-index:1;width:100%;border-bottom:1px solid #d4dadf;height:64px;padding:0 24px 0 2px"><div class="ant-row ant-row-center" style="max-width:992px;justify-content:space-between;margin:0 auto"><div style="display:flex" class="ant-col ant-col-xs-20 ant-col-sm-4"></div><div class="ant-col gutter-row ant-col-xs-0 ant-col-sm-20 ant-col-md-20 ant-col-lg-19"><div class="ant-select ant-select-lg ant-select-auto-complete ant-select-single ant-select-allow-clear ant-select-show-search" style="width:100%"><div class="ant-select-selector"><span class="ant-select-selection-search"><input type="search" autoComplete="off" class="ant-select-selection-search-input" role="combobox" aria-haspopup="listbox" aria-owns="undefined_list" aria-autocomplete="list" aria-controls="undefined_list" aria-activedescendant="undefined_list_0" value=""/></span><span class="ant-select-selection-placeholder">For full text search please use the &#x27;?&#x27; prefix. e.g. ? Onboarding</span></div></div></div><div style="display:none;align-items:center;justify-content:center" class="ant-col ant-col-xs-4 ant-col-sm-4 ant-col-md-0 ant-col-lg-0"><span role="img" aria-label="menu" style="font-size:24px" tabindex="-1" class="anticon anticon-menu"><svg viewBox="64 64 896 896" focusable="false" data-icon="menu" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M904 160H120c-4.4 0-8 3.6-8 8v64c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-64c0-4.4-3.6-8-8-8zm0 624H120c-4.4 0-8 3.6-8 8v64c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-64c0-4.4-3.6-8-8-8zm0-312H120c-4.4 0-8 3.6-8 8v64c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-64c0-4.4-3.6-8-8-8z"></path></svg></span></div></div></header><section class="ant-layout" style="margin-top:64px;display:flex;flex-direction:row"><div class="site-layout-sidebar" style="flex:0 0 auto;width:calc(max((100% - 992px) / 2, 0px) + 200px);min-width:200px;padding-left:calc((100% - 992px) / 2)"><aside class="ant-layout-sider ant-layout-sider-dark" style="position:fixed;overflow:auto;height:calc(100vh - 64px);background-color:transparent;flex:0 0 200px;max-width:200px;min-width:200px;width:200px"><div class="ant-layout-sider-children"></div></aside></div><main class="ant-layout-content side-layout-main" style="max-width:1200px;min-width:0;display:block"><div style="padding:0 24px"><div class="main-content" role="main"><div class="ant-row"><div class="ant-col ant-col-24"><div class="ant-row" style="margin-left:-10px;margin-right:-10px"><div style="padding-left:10px;padding-right:10px" class="ant-col ant-col-xs-24 ant-col-md-18"><div><h1 id="sql">SQL<a aria-hidden="true" class="anchor-heading icon-link" href="#sql"></a></h1>
<p>Most notes here are from <a href="https://www.youtube.com/watch?v=Yceqbp_DKbA&#x26;list=PL9ysvtVnryGpnIj9rcIqNDxakUn6v72Hm&#x26;index=103">Stanford lectures</a> and leetcode.</p>
<h1 id="buzzwords">Buzzwords<a aria-hidden="true" class="anchor-heading icon-link" href="#buzzwords"></a></h1>
<p>relational algebra, relational data model, relational database, DBMS (database management system), PostgreSQL, MySQL, declarative, power of set theory, projection, persistent data (outlives program), schema (type) vs data(variables), DDL (data definition language) used to set up schema, DML (data manipulation language = query language), database = set of named relations, relation = table, columns = attributes of relation, rows = tuple, schema = structural description of relations in database, ACID properties, select = project operator, cross product, join, inner, outer, left, right, union, join = cross product + where, CTE = common table expression, subquery, normalization, denormalization, sharding, shards, transactions</p>
<ul>
<li>SQL is declarative - you say "what" you want but not how you want it</li>
<li>SQL is not "Turing complete" = computationally universal (can do all stuff)</li>
<li>basic SQL cannot run unbounded computations (no for loops)</li>
</ul>
<h1 id="code-snippets">Code snippets<a aria-hidden="true" class="anchor-heading icon-link" href="#code-snippets"></a></h1>
<ul>
<li>join</li>
</ul>
<pre class="language-sql"><code class="language-sql"><span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> table1 t1
<span class="token keyword">left</span> <span class="token keyword">join</span> table2 t2
<span class="token keyword">on</span> t1<span class="token punctuation">.</span>id <span class="token operator">=</span> t2<span class="token punctuation">.</span>id

<span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> t1
<span class="token keyword">left</span> <span class="token keyword">join</span> t2 <span class="token keyword">using</span><span class="token punctuation">(</span>product_id<span class="token punctuation">)</span>
</code></pre>
<ul>
<li>no full outer join in MySQL. Emulate it by:</li>
</ul>
<pre class="language-sql"><code class="language-sql"><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> t1
<span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> t2 <span class="token keyword">ON</span> t1<span class="token punctuation">.</span>id <span class="token operator">=</span> t2<span class="token punctuation">.</span>id
<span class="token keyword">UNION</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> t1
<span class="token keyword">RIGHT</span> <span class="token keyword">JOIN</span> t2 <span class="token keyword">ON</span> t1<span class="token punctuation">.</span>id <span class="token operator">=</span> t2<span class="token punctuation">.</span>id
</code></pre>
<ul>
<li>join on operations <a href="https://leetcode.com/problems/leetflex-banned-accounts/">leetcode</a></li>
</ul>
<pre><code>sometimes is smart to do joins on operations/conditions
join on t1.id = t2.id-1
</code></pre>
<ul>
<li>
<p><strong>join is just a cross product with where statements</strong></p>
</li>
<li>
<p>conditional statement case when else end</p>
</li>
</ul>
<pre class="language-sql"><code class="language-sql"><span class="token keyword">select</span>
<span class="token punctuation">(</span><span class="token keyword">case</span>
    <span class="token keyword">when</span> condition1 <span class="token keyword">then</span> result1
    <span class="token keyword">when</span> condition2 <span class="token keyword">then</span> result2
    <span class="token keyword">when</span> conditionN <span class="token keyword">then</span> resultN
    <span class="token keyword">else</span> result <span class="token comment"># else can be dropped too</span>
<span class="token keyword">end</span><span class="token punctuation">)</span> <span class="token keyword">as</span> field
<span class="token keyword">from</span> <span class="token keyword">table</span>
</code></pre>
<ul>
<li>if conditional statement</li>
</ul>
<pre class="language-sql"><code class="language-sql"><span class="token keyword">select</span> <span class="token keyword">if</span><span class="token punctuation">(</span>condition<span class="token punctuation">,</span> true_val<span class="token punctuation">,</span> false_val<span class="token punctuation">)</span> <span class="token keyword">as</span> field
<span class="token keyword">from</span> <span class="token keyword">table</span>
</code></pre>
<ul>
<li>least, greatest to take min,max of a row <a href="https://leetcode.com/problems/number-of-calls-between-two-persons/">leetcode</a></li>
</ul>
<pre class="language-sql"><code class="language-sql"><span class="token keyword">select</span> least<span class="token punctuation">(</span>from_id<span class="token punctuation">,</span>to_id<span class="token punctuation">)</span> <span class="token keyword">as</span> person1<span class="token punctuation">,</span> greatest<span class="token punctuation">(</span>from_id<span class="token punctuation">,</span>to_id<span class="token punctuation">)</span> <span class="token keyword">as</span> person2<span class="token punctuation">,</span>
        <span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">as</span> call_count<span class="token punctuation">,</span> <span class="token function">sum</span><span class="token punctuation">(</span>duration<span class="token punctuation">)</span> <span class="token keyword">as</span> total_duration
<span class="token keyword">from</span> calls
<span class="token keyword">group</span> <span class="token keyword">by</span> person1<span class="token punctuation">,</span>person2
</code></pre>
<ul>
<li>
<p>partition by <a href="https://leetcode.com/problems/find-the-quiet-students-in-all-exams/discuss/1414605/Become-the-Master-of-Partition-By">leetcode</a></p>
</li>
<li>
<p>window question <a href="https://leetcode.com/problems/biggest-window-between-visits/">leetcode</a></p>
</li>
<li>
<p>date operations</p>
</li>
</ul>
<pre class="language-sql"><code class="language-sql"><span class="token keyword">select</span> 
        datediff<span class="token punctuation">(</span>date1<span class="token punctuation">,</span>date2<span class="token punctuation">)</span> <span class="token keyword">as</span> diff<span class="token punctuation">,</span> <span class="token comment">-- measred in days</span>
        period_diff<span class="token punctuation">(</span><span class="token string">'202210'</span><span class="token punctuation">,</span><span class="token string">'202301'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> diff<span class="token punctuation">,</span> <span class="token comment">-- measured in months</span>
        <span class="token keyword">month</span><span class="token punctuation">(</span>date1<span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token keyword">month</span><span class="token punctuation">,</span>
        date_add<span class="token punctuation">(</span><span class="token string">'2018-05-01'</span><span class="token punctuation">,</span><span class="token keyword">INTERVAL</span> <span class="token number">1</span> <span class="token keyword">DAY</span><span class="token punctuation">)</span> <span class="token keyword">as</span> next_day<span class="token punctuation">,</span>
        dayofweek<span class="token punctuation">(</span><span class="token string">'2007-02-03'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> day_of_week <span class="token comment"># 1 to 7 (1 and 7 are weekend)</span>
        dayofyear<span class="token punctuation">(</span><span class="token string">'2007-02-03'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> day_of_week<span class="token punctuation">,</span>
        to_days<span class="token punctuation">(</span><span class="token string">'2008-01-01'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> date_number<span class="token punctuation">,</span>
        date_format<span class="token punctuation">(</span><span class="token keyword">date</span><span class="token punctuation">,</span><span class="token string">'%d/%m/%Y'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> formatted_date<span class="token punctuation">,</span>
        least<span class="token punctuation">(</span><span class="token string">'2018-12-31'</span><span class="token punctuation">,</span><span class="token keyword">date</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        greatest<span class="token punctuation">(</span>d1<span class="token punctuation">,</span>d2<span class="token punctuation">)</span>
</code></pre>
<ul>
<li>date_part, date operations in postgresql - give PART of the DATE</li>
<li><a href="https://leetcode.com/problems/tasks-count-in-the-weekend/">leetcode</a> you can test your functions here</li>
</ul>
<pre class="language-sql"><code class="language-sql"><span class="token keyword">select</span> 
DATE_PART<span class="token punctuation">(</span><span class="token string">'field'</span><span class="token punctuation">,</span> column_name<span class="token punctuation">)</span> <span class="token comment">-- need to use these quotation marks ''</span>
<span class="token keyword">SELECT</span> DATE_PART<span class="token punctuation">(</span><span class="token string">'year'</span><span class="token punctuation">,</span> <span class="token keyword">TIMESTAMP</span> <span class="token string">'2024-07-06 15:23:10'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">-- 2024</span>
<span class="token keyword">SELECT</span> DATE_PART<span class="token punctuation">(</span><span class="token string">'day'</span><span class="token punctuation">,</span> <span class="token keyword">DATE</span> <span class="token string">'2024-07-06'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                   <span class="token comment">-- 6</span>
<span class="token keyword">SELECT</span> DATE_PART<span class="token punctuation">(</span><span class="token string">'month'</span><span class="token punctuation">,</span> <span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                             <span class="token comment">-- current month as number</span>
<span class="token keyword">SELECT</span> DATE_PART<span class="token punctuation">(</span><span class="token string">'dow'</span><span class="token punctuation">,</span> <span class="token keyword">DATE</span> <span class="token string">'2024-07-06'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                   <span class="token comment">-- 6 (Saturday, 0 = Sunday)</span>
<span class="token keyword">from</span> t
</code></pre>
<ul>
<li><code>field</code> can be 'year', 'month', 'day', 'dow', 'hour', 'minute', 'second'</li>
<li>'dow' gives a number where 0 is Sunday and 6 is Saturday</li>
</ul>
<ul>
<li>date_trunc truncates the date column to the specified precision (beginning of month, year and so on)</li>
</ul>
<pre class="language-sql"><code class="language-sql"><span class="token keyword">SELECT</span> DATE_TRUNC<span class="token punctuation">(</span><span class="token string">'month'</span><span class="token punctuation">,</span> <span class="token keyword">TIMESTAMP</span> <span class="token string">'2024-07-06 15:23:10'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">-- '2024-07-01 00:00:00'</span>
<span class="token keyword">SELECT</span> DATE_TRUNC<span class="token punctuation">(</span><span class="token string">'day'</span><span class="token punctuation">,</span> <span class="token keyword">TIMESTAMP</span> <span class="token string">'2024-07-06 15:23:10'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token comment">-- '2024-07-06 00:00:00'</span>
<span class="token keyword">SELECT</span> DATE_TRUNC<span class="token punctuation">(</span><span class="token string">'year'</span><span class="token punctuation">,</span> <span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                              <span class="token comment">-- start of this year</span>
</code></pre>
<ul>
<li>
<p>TIMESTAMP, DATE, INTERVAL . they all convert string to date-like object</p>
</li>
<li>
<p>INTERVAL represents a unit of time that can be added or subtracted from dates</p>
</li>
</ul>
<pre class="language-sql"><code class="language-sql"><span class="token keyword">INTERVAL</span> <span class="token string">'N unit'</span> <span class="token comment">-- unit can be 'day', 'days', 'month', 'week', 'hour' etc</span>
</code></pre>
<pre class="language-sql"><code class="language-sql"><span class="token keyword">SELECT</span> <span class="token keyword">TIMESTAMP</span> <span class="token string">'2025-05-01 15:45:01'</span> <span class="token operator">+</span> <span class="token keyword">INTERVAL</span> <span class="token string">'10 minutes'</span><span class="token punctuation">,</span>
<span class="token keyword">TIMESTAMP</span> <span class="token string">'2025-05-01 15:45:01'</span> <span class="token operator">-</span> <span class="token keyword">INTERVAL</span> <span class="token string">'10 minute'</span> <span class="token keyword">as</span> a<span class="token punctuation">,</span>
<span class="token keyword">TIMESTAMP</span> <span class="token string">'2025-05-01 15:45:01'</span> <span class="token operator">+</span> <span class="token keyword">INTERVAL</span> <span class="token string">'1 week'</span> <span class="token keyword">as</span> b
</code></pre>
<ul>
<li>casting in postgreSQL</li>
</ul>
<ol>
<li>
<p>Use ::typename or CAST(value AS typename)</p>
</li>
<li>
<p>If in doubt, cast explicitly.</p>
</li>
</ol>
<pre class="language-sql"><code class="language-sql"><span class="token keyword">SELECT</span> <span class="token string">'2023-08-16'</span>::<span class="token keyword">date</span><span class="token punctuation">;</span>                 <span class="token comment">-- 2023-08-16</span>
<span class="token keyword">SELECT</span> <span class="token string">'2023-08-16 15:20'</span>::<span class="token keyword">timestamp</span><span class="token punctuation">;</span>      <span class="token comment">-- 2023-08-16 15:20:00</span>
<span class="token keyword">SELECT</span> <span class="token string">'123'</span>::<span class="token keyword">integer</span><span class="token punctuation">;</span>       <span class="token comment">-- 123 (text to int)</span>
<span class="token keyword">SELECT</span> <span class="token number">123</span>::<span class="token keyword">text</span><span class="token punctuation">;</span>            <span class="token comment">-- '123' (int to text)</span>
</code></pre>
<ul>
<li>width_bucket</li>
</ul>
<pre class="language-sql"><code class="language-sql"><span class="token keyword">select</span> width_bucket<span class="token punctuation">(</span>column_name<span class="token punctuation">,</span> min_value<span class="token punctuation">,</span> max_value<span class="token punctuation">,</span> number_of_buckets<span class="token punctuation">)</span> <span class="token comment">-- max_value is the upper bound of the last bucket non-exclusive [)</span>
<span class="token keyword">select</span> width_bucket<span class="token punctuation">(</span>score<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">101</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span> <span class="token comment">-- 5 buckets [1,20], [21- 40] ... </span>
</code></pre>
<ul>
<li>subquery in select statement example <a href="https://leetcode.com/problems/percentage-of-users-attended-a-contest/">leetcode</a></li>
</ul>
<pre class="language-sql"><code class="language-sql"><span class="token keyword">select</span> contest_id<span class="token punctuation">,</span> <span class="token function">round</span><span class="token punctuation">(</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">from</span> users<span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">100</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">as</span> percentage
<span class="token keyword">from</span> register
<span class="token keyword">group</span> <span class="token keyword">by</span> contest_id
<span class="token keyword">order</span> <span class="token keyword">by</span> percentage <span class="token keyword">desc</span><span class="token punctuation">,</span> contest_id <span class="token keyword">asc</span>
</code></pre>
<ul>
<li>where clauses</li>
</ul>
<pre class="language-sql"><code class="language-sql"><span class="token keyword">where</span> field <span class="token operator">in</span> <span class="token punctuation">(</span><span class="token string">'string'</span><span class="token punctuation">,</span> <span class="token string">'string1'</span><span class="token punctuation">)</span>
<span class="token keyword">where</span> a <span class="token operator">=</span> <span class="token number">6</span> <span class="token operator">or</span> a <span class="token operator">=</span> <span class="token number">9</span>
<span class="token keyword">where</span> low <span class="token operator">&#x3C;</span> a <span class="token operator">and</span> a <span class="token operator">&#x3C;</span> high
</code></pre>
<ul>
<li>not in operator with null values CAREFUL <a href="https://stackoverflow.com/questions/129077/null-values-inside-not-in-clause">stackoverflow</a> <a href="https://leetcode.com/problems/tree-node/submissions/">leetcode</a>
<a href="https://leetcode.com/problems/find-customer-referee/">584</a></li>
</ul>
<pre><code>MySQL uses three-valued logic -- TRUE, FALSE and UNKNOWN. Anything compared to NULL evaluates to the third value: UNKNOWN. That “anything” includes NULL itself! That’s why MySQL provides the IS NULL and IS NOT NULL operators to specifically check for NULL.
</code></pre>
<pre class="language-sql"><code class="language-sql"><span class="token keyword">select</span> name
<span class="token keyword">from</span> customer
<span class="token keyword">where</span> referee_id <span class="token operator">!=</span> <span class="token number">2</span> <span class="token operator">or</span> referee_id <span class="token operator">is</span> <span class="token boolean">null</span>
</code></pre>
<ul>
<li>filling in null values - use the IS operator</li>
</ul>
<pre class="language-sql"><code class="language-sql"><span class="token keyword">case</span>
<span class="token keyword">when</span> field <span class="token operator">is</span> <span class="token boolean">null</span> <span class="token keyword">then</span> <span class="token number">0</span> <span class="token comment"># field = 0 would not work</span>
<span class="token keyword">else</span> field <span class="token keyword">end</span>
</code></pre>
<pre class="language-sql"><code class="language-sql">IFNULL<span class="token punctuation">(</span>field<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> field
</code></pre>
<ul>
<li>delete</li>
</ul>
<pre class="language-sql"><code class="language-sql"><span class="token keyword">DELETE</span> <span class="token keyword">FROM</span> table_name <span class="token keyword">WHERE</span> condition<span class="token punctuation">;</span>
</code></pre>
<ul>
<li>delete <a href="https://leetcode.com/problems/delete-duplicate-emails/">problem</a>, cannot delete from referenced table and need to create a temporary copy</li>
</ul>
<pre class="language-sql"><code class="language-sql"><span class="token comment"># delete from person</span>
<span class="token comment"># where id not in (select min(id) from person group by email) </span>

<span class="token comment"># create temporary copy of table</span>
<span class="token keyword">delete</span> <span class="token keyword">from</span> person
<span class="token keyword">where</span> id <span class="token operator">not</span> <span class="token operator">in</span> <span class="token punctuation">(</span><span class="token keyword">select</span> t<span class="token punctuation">.</span>id <span class="token keyword">from</span> <span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token function">min</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span> <span class="token keyword">as</span> id <span class="token keyword">from</span> person <span class="token keyword">group</span> <span class="token keyword">by</span> email<span class="token punctuation">)</span> t<span class="token punctuation">)</span>

</code></pre>
<ul>
<li>substring(col_name, start_index, length), length is optional</li>
</ul>
<pre class="language-sql"><code class="language-sql"> <span class="token keyword">SELECT</span> SUBSTRING<span class="token punctuation">(</span><span class="token string">'SQL Tutorial'</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> ExtractString<span class="token punctuation">;</span>

</code></pre>
<ul>
<li>union, union all</li>
</ul>
<pre class="language-sql"><code class="language-sql">t1
<span class="token keyword">union</span>
t2 <span class="token comment"># duplicates are removed</span>

t1
<span class="token keyword">union</span> <span class="token keyword">all</span>
t2 <span class="token comment"># duplicates are stacked</span>
</code></pre>
<ul>
<li>between</li>
</ul>
<pre class="language-sql"><code class="language-sql"><span class="token keyword">SELECT</span> column_name<span class="token punctuation">(</span>s<span class="token punctuation">)</span>
<span class="token keyword">FROM</span> table_name
<span class="token keyword">WHERE</span> column_name <span class="token operator">BETWEEN</span> value1 <span class="token operator">AND</span> value2<span class="token punctuation">;</span>
</code></pre>
<ul>
<li><a href="https://leetcode.com/problems/change-null-values-in-a-table-to-the-previous-value/">2388</a> Change Null Values in a Table to the Previous Value</li>
</ul>
<pre class="language-sql"><code class="language-sql"><span class="token keyword">with</span> cte <span class="token keyword">as</span> <span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token operator">*</span><span class="token punctuation">,</span> row_number<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">over</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">as</span> row_num<span class="token punctuation">,</span> <span class="token keyword">if</span><span class="token punctuation">(</span>isnull<span class="token punctuation">(</span>drink<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">as</span> flag <span class="token keyword">from</span> coffeeshop<span class="token punctuation">)</span><span class="token punctuation">,</span>
     cte2 <span class="token keyword">as</span> <span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token operator">*</span><span class="token punctuation">,</span> <span class="token function">sum</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span> <span class="token keyword">over</span><span class="token punctuation">(</span><span class="token keyword">order</span> <span class="token keyword">by</span> row_num<span class="token punctuation">)</span> <span class="token keyword">as</span> group_id <span class="token keyword">from</span> cte<span class="token punctuation">)</span>
<span class="token keyword">select</span> id<span class="token punctuation">,</span> first_value<span class="token punctuation">(</span>drink<span class="token punctuation">)</span> <span class="token keyword">over</span><span class="token punctuation">(</span><span class="token keyword">partition</span> <span class="token keyword">by</span> group_id<span class="token punctuation">)</span> <span class="token keyword">as</span> drink
<span class="token keyword">from</span> cte2
</code></pre>
<ul>
<li>concatanete two strings</li>
</ul>
<pre class="language-sql"><code class="language-sql"><span class="token keyword">select</span> concat<span class="token punctuation">(</span>s1<span class="token punctuation">,</span>s2<span class="token punctuation">)</span> <span class="token keyword">as</span> combined 
<span class="token keyword">from</span> t
</code></pre>
<ul>
<li>lower case, upper case</li>
</ul>
<pre class="language-sql"><code class="language-sql"><span class="token keyword">select</span> lower<span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">,</span> upper<span class="token punctuation">(</span>s<span class="token punctuation">)</span>
<span class="token keyword">from</span> t
</code></pre>
<ul>
<li>functions in SQL <a href="https://leetcode.com/problems/nth-highest-salary/">leetcode</a></li>
</ul>
<pre class="language-sql"><code class="language-sql"><span class="token keyword">CREATE</span> <span class="token keyword">FUNCTION</span> getNthHighestSalary<span class="token punctuation">(</span>N <span class="token keyword">INT</span><span class="token punctuation">)</span> <span class="token keyword">RETURNS</span> <span class="token keyword">INT</span>
<span class="token keyword">BEGIN</span>
  <span class="token keyword">RETURN</span> <span class="token punctuation">(</span>
      <span class="token comment"># Write your MySQL query statement below.</span>

  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">END</span>
</code></pre>
<p>-limit + offset <a href="https://leetcode.com/problems/nth-highest-salary/">leetcode</a></p>
<pre class="language-sql"><code class="language-sql"><span class="token keyword">SELECT</span>
    column_list
<span class="token keyword">FROM</span>
    table1
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> column_list
<span class="token keyword">LIMIT</span> row_count <span class="token keyword">OFFSET</span> <span class="token keyword">offset</span><span class="token punctuation">;</span>

<span class="token comment"># The LIMIT row_count determines the number of rows (row_count) returned by the query.</span>
<span class="token comment"># The OFFSET offset clause skips the offset rows before beginning to return the rows.</span>
<span class="token comment"># OFFSET is optional</span>
</code></pre>
<ul>
<li>rank in over(partition by)</li>
</ul>
<pre class="language-sql"><code class="language-sql">RANK <span class="token punctuation">(</span> <span class="token punctuation">)</span> <span class="token keyword">OVER</span> <span class="token punctuation">(</span> <span class="token punctuation">[</span> partition_by_clause <span class="token punctuation">]</span> order_by_clause <span class="token punctuation">)</span>  

ProductID   Name                   LocationID   Quantity Rank  
<span class="token comment">----------- ---------------------- ------------ -------- ----  </span>
<span class="token number">494</span>         Paint <span class="token operator">-</span> Silver         <span class="token number">3</span>            <span class="token number">49</span>       <span class="token number">1</span>  
<span class="token number">495</span>         Paint <span class="token operator">-</span> Blue           <span class="token number">3</span>            <span class="token number">49</span>       <span class="token number">1</span>  
<span class="token number">493</span>         Paint <span class="token operator">-</span> Red            <span class="token number">3</span>            <span class="token number">41</span>       <span class="token number">3</span>  
<span class="token number">496</span>         Paint <span class="token operator">-</span> Yellow         <span class="token number">3</span>            <span class="token number">30</span>       <span class="token number">4</span>
</code></pre>
<ul>
<li>dense rank <a href="https://leetcode.com/problems/department-top-three-salaries/">leetcode</a></li>
</ul>
<pre class="language-sql"><code class="language-sql">DENSE_RANK <span class="token punctuation">(</span> <span class="token punctuation">)</span> <span class="token keyword">OVER</span> <span class="token punctuation">(</span> <span class="token punctuation">[</span> <span class="token operator">&#x3C;</span>partition_by_clause<span class="token operator">></span> <span class="token punctuation">]</span> <span class="token operator">&#x3C;</span> order_by_clause <span class="token operator">></span> <span class="token punctuation">)</span>  
ProductID   Name                               LocationID Quantity Rank  
<span class="token comment">----------- ---------------------------------- ---------- -------- -----  </span>
<span class="token number">494</span>         Paint <span class="token operator">-</span> Silver                     <span class="token number">3</span>          <span class="token number">49</span>       <span class="token number">1</span>  
<span class="token number">495</span>         Paint <span class="token operator">-</span> Blue                       <span class="token number">3</span>          <span class="token number">49</span>       <span class="token number">1</span>  
<span class="token number">493</span>         Paint <span class="token operator">-</span> Red                        <span class="token number">3</span>          <span class="token number">41</span>       <span class="token number">2</span>  
<span class="token number">496</span>         Paint <span class="token operator">-</span> Yellow                     <span class="token number">3</span>          <span class="token number">30</span>       <span class="token number">3</span>  
</code></pre>
<ul>
<li>cumulative total</li>
</ul>
<pre class="language-sql"><code class="language-sql"><span class="token keyword">SELECT</span> Id<span class="token punctuation">,</span> StudentName<span class="token punctuation">,</span>  StudentAge<span class="token punctuation">,</span>
<span class="token function">SUM</span> <span class="token punctuation">(</span>StudentAge<span class="token punctuation">)</span> <span class="token keyword">OVER</span> <span class="token punctuation">(</span><span class="token keyword">ORDER</span> <span class="token keyword">BY</span> Id<span class="token punctuation">)</span> <span class="token keyword">AS</span> RunningAgeTotal
<span class="token keyword">FROM</span> Students
</code></pre>
<ul>
<li>rolling sum/average</li>
</ul>
<pre class="language-sql"><code class="language-sql"><span class="token keyword">select</span> visited_on<span class="token punctuation">,</span> 
            <span class="token function">sum</span><span class="token punctuation">(</span>amount<span class="token punctuation">)</span> <span class="token keyword">over</span><span class="token punctuation">(</span><span class="token keyword">order</span> <span class="token keyword">by</span> visited_on <span class="token keyword">rows</span> <span class="token operator">between</span> <span class="token number">6</span> <span class="token keyword">preceding</span> <span class="token operator">and</span> <span class="token keyword">current</span> <span class="token keyword">row</span><span class="token punctuation">)</span> <span class="token keyword">as</span> amount<span class="token punctuation">,</span>
            <span class="token function">avg</span><span class="token punctuation">(</span>amount<span class="token punctuation">)</span> <span class="token keyword">over</span><span class="token punctuation">(</span><span class="token keyword">order</span> <span class="token keyword">by</span> visited_on <span class="token keyword">rows</span> <span class="token operator">between</span> <span class="token number">6</span> <span class="token keyword">preceding</span> <span class="token operator">and</span> <span class="token keyword">current</span> <span class="token keyword">row</span><span class="token punctuation">)</span> <span class="token keyword">as</span> average_amount
<span class="token keyword">from</span> customer
</code></pre>
<ul>
<li>
<p>window functions</p>
<ul>
<li>sum, avg, first, lead, lag, rank, dense_rank</li>
</ul>
</li>
<li>
<p>lag window function</p>
</li>
</ul>
<pre class="language-sql"><code class="language-sql"><span class="token keyword">select</span> <span class="token operator">*</span><span class="token punctuation">,</span> lag<span class="token punctuation">(</span>purchase_date<span class="token punctuation">)</span> <span class="token keyword">over</span><span class="token punctuation">(</span><span class="token keyword">partition</span> <span class="token keyword">by</span> user_id <span class="token keyword">order</span> <span class="token keyword">by</span> purchase_date<span class="token punctuation">)</span> <span class="token keyword">as</span> previous_date
<span class="token keyword">from</span> purchases
</code></pre>
<ul>
<li>lead, window function for value in the next row</li>
</ul>
<pre class="language-sql"><code class="language-sql"><span class="token keyword">SELECT</span> dept_id<span class="token punctuation">,</span> last_name<span class="token punctuation">,</span> salary<span class="token punctuation">,</span>
LEAD <span class="token punctuation">(</span>salary<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">OVER</span> <span class="token punctuation">(</span><span class="token keyword">ORDER</span> <span class="token keyword">BY</span> salary<span class="token punctuation">)</span> <span class="token keyword">AS</span> next_highest_salary
<span class="token keyword">FROM</span> employees<span class="token punctuation">;</span>
</code></pre>
<ul>
<li>like, search in substring, <a href="https://leetcode.com/problems/patients-with-a-condition/">patients</a></li>
</ul>
<pre class="language-sql"><code class="language-sql"><span class="token keyword">select</span> col
<span class="token keyword">from</span> <span class="token keyword">table</span>
<span class="token keyword">where</span> col <span class="token operator">like</span> <span class="token string">'%KUR%'</span>
</code></pre>
<ul>
<li>
<p>to get island values (group of equal consecutive values in a column) use rank- rank trick, <a href="https://leetcode.com/problems/longest-winning-streak/">leetcode</a></p>
</li>
<li>
<p>CAST to datatypes</p>
</li>
</ul>
<pre class="language-sql"><code class="language-sql"><span class="token comment">-- For Sql server</span>
<span class="token keyword">SELECT</span> CAST<span class="token punctuation">(</span><span class="token number">25.65</span> <span class="token keyword">AS</span> <span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">/*
CAST(&#x3C;value_to_cast> AS &#x3C;data_type_to_cast_to>)
*/</span>
</code></pre>
<ul>
<li>put stuff in one cell table with group_concat</li>
</ul>
<pre><code>+------------+------------+
| sell_date  | product     |
+------------+------------+
| 2020-05-30 | Headphone  |
| 2020-06-01 | Pencil     |
| 2020-06-02 | Mask       |
| 2020-05-30 | Basketball |
| 2020-06-01 | Bible      |
+------------+------------+

TO

+------------+----------+------------------------------+
| sell_date  | num_sold | products                     |
+------------+----------+------------------------------+
| 2020-05-30 | 3        | Basketball,Headphone,T-shirt |
| 2020-06-01 | 2        | Bible,Pencil                 |
| 2020-06-02 | 1        | Mask                         |
+------------+----------+------------------------------+
</code></pre>
<pre class="language-sql"><code class="language-sql"><span class="token comment"># Write your MySQL query statement below</span>
<span class="token keyword">select</span> sell_date<span class="token punctuation">,</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token keyword">distinct</span> product<span class="token punctuation">)</span> <span class="token keyword">as</span> num_sold<span class="token punctuation">,</span> 
group_concat<span class="token punctuation">(</span><span class="token keyword">distinct</span> product <span class="token keyword">order</span> <span class="token keyword">by</span> product separator <span class="token string">','</span><span class="token punctuation">)</span> <span class="token keyword">as</span> products
<span class="token keyword">from</span> activities
<span class="token keyword">group</span> <span class="token keyword">by</span> sell_date
</code></pre>
<ul>
<li>pivot trick <a href="https://leetcode.com/problems/students-report-by-geography/">student by geography</a></li>
</ul>
<pre class="language-sql"><code class="language-sql"><span class="token comment"># Write your MySQL query statement below</span>
<span class="token keyword">select</span> <span class="token function">max</span><span class="token punctuation">(</span><span class="token keyword">case</span> <span class="token keyword">when</span> continent <span class="token operator">=</span> <span class="token string">'America'</span> <span class="token keyword">then</span> name <span class="token keyword">end</span><span class="token punctuation">)</span> <span class="token keyword">as</span> America<span class="token punctuation">,</span>
       <span class="token function">max</span><span class="token punctuation">(</span><span class="token keyword">case</span> <span class="token keyword">when</span> continent <span class="token operator">=</span> <span class="token string">'Asia'</span> <span class="token keyword">then</span> name <span class="token keyword">end</span><span class="token punctuation">)</span> <span class="token keyword">as</span> Asia<span class="token punctuation">,</span>
       <span class="token function">max</span><span class="token punctuation">(</span><span class="token keyword">case</span> <span class="token keyword">when</span> continent <span class="token operator">=</span> <span class="token string">'Europe'</span> <span class="token keyword">then</span> name <span class="token keyword">end</span><span class="token punctuation">)</span> <span class="token keyword">as</span> Europe
<span class="token keyword">from</span>
<span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token operator">*</span><span class="token punctuation">,</span> row_number<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">over</span><span class="token punctuation">(</span><span class="token keyword">partition</span> <span class="token keyword">by</span> continent <span class="token keyword">order</span> <span class="token keyword">by</span> name<span class="token punctuation">)</span> <span class="token keyword">as</span> rn
<span class="token keyword">from</span> student<span class="token punctuation">)</span> t
<span class="token keyword">group</span> <span class="token keyword">by</span> rn
</code></pre>
<ul>
<li><a href="https://leetcode.com/problems/dynamic-pivoting-of-a-table/">dynamic pivoting</a></li>
</ul>
<pre class="language-sql"><code class="language-sql"><span class="token comment">-- static pivot</span>
<span class="token comment">-- select product_id,</span>
<span class="token comment">-- sum(case when store = "store1" then price end) as store1,</span>
<span class="token comment">-- sum(case when store = "store"then price end) as store2,</span>
<span class="token comment">-- ....</span>
<span class="token comment">-- from products</span>
<span class="token comment">-- group by product_id</span>


<span class="token comment">-- this procedusre would concatenate all select statements in case_stmtsum(..)</span>
<span class="token keyword">CREATE</span> <span class="token keyword">PROCEDURE</span> PivotProducts<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">BEGIN</span>
	<span class="token comment"># Write your MySQL query statement below.</span>
    <span class="token keyword">SET</span> <span class="token keyword">SESSION</span> group_concat_max_len <span class="token operator">=</span> <span class="token number">1000000</span><span class="token punctuation">;</span>
    <span class="token comment">--define case statement</span>
    <span class="token keyword">select</span> group_concat<span class="token punctuation">(</span><span class="token keyword">distinct</span> concat<span class="token punctuation">(</span><span class="token string">'sum(case when store = "'</span><span class="token punctuation">,</span>store<span class="token punctuation">,</span><span class="token string">'" then price end) as '</span><span class="token punctuation">,</span> store<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">into</span> <span class="token variable">@case_stmt</span>
    <span class="token keyword">from</span> products<span class="token punctuation">;</span>
    <span class="token comment">-- get whole sql query</span>
    <span class="token keyword">set</span> <span class="token variable">@sql_query</span> <span class="token operator">=</span> concat<span class="token punctuation">(</span><span class="token string">'select product_id, '</span><span class="token punctuation">,</span><span class="token variable">@case_stmt</span><span class="token punctuation">,</span> <span class="token string">' from products group by product_id'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token keyword">prepare</span> final_sql_query <span class="token keyword">from</span> <span class="token variable">@sql_query</span><span class="token punctuation">;</span>
    <span class="token keyword">execute</span> final_sql_query<span class="token punctuation">;</span>
    <span class="token keyword">deallocate</span> <span class="token keyword">prepare</span> final_sql_query<span class="token punctuation">;</span>
<span class="token keyword">END</span>
</code></pre>
<ul>
<li><a href="https://leetcode.com/problems/dynamic-unpivoting-of-a-table/">dynamic unpivoting</a></li>
</ul>
<ul>
<li><a href="https://stackoverflow.com/questions/9917196/meaning-of-square-brackets-in-ms-sql-table-designer">delimit identifiers</a>, ignore special symbols, characters, spaces etc</li>
</ul>
<pre class="language-sql"><code class="language-sql"><span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> <span class="token punctuation">[</span>my <span class="token keyword">table</span><span class="token punctuation">]</span>
<span class="token keyword">where</span> <span class="token punctuation">[</span><span class="token keyword">order</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">10</span>
</code></pre>
<ul>
<li>index column</li>
</ul>
<pre class="language-sql"><code class="language-sql"><span class="token keyword">CREATE</span> <span class="token keyword">INDEX</span> <span class="token punctuation">[</span><span class="token keyword">index</span> name<span class="token punctuation">]</span> <span class="token keyword">ON</span> <span class="token punctuation">[</span><span class="token keyword">table</span> name<span class="token punctuation">]</span> <span class="token punctuation">(</span> <span class="token punctuation">[</span><span class="token keyword">column</span> name<span class="token punctuation">]</span> <span class="token punctuation">)</span>
</code></pre>
<p>-transactions</p>
<pre class="language-sql"><code class="language-sql"><span class="token keyword">BEGIN</span> <span class="token keyword">TRANSACTION</span>
<span class="token keyword">BEGIN</span> TRY

<span class="token keyword">UPDATE</span> table_name <span class="token keyword">SET</span> BAKIYE <span class="token operator">=</span> BAKIYE <span class="token operator">-</span> <span class="token number">1000</span>
<span class="token keyword">WHERE</span> Name<span class="token operator">=</span><span class="token string">'Name'</span> <span class="token operator">AND</span> Surname<span class="token operator">=</span><span class="token string">'Surname'</span>

<span class="token keyword">UPDATE</span> table_name <span class="token keyword">SET</span> BAKIYE <span class="token operator">=</span> BAKIYE <span class="token operator">+</span> <span class="token number">1000</span>
<span class="token keyword">WHERE</span> Name<span class="token operator">=</span><span class="token string">'Name'</span> <span class="token operator">AND</span> Surname<span class="token operator">=</span><span class="token string">'Surname'</span>

<span class="token keyword">update</span> salary <span class="token keyword">set</span> sex <span class="token operator">=</span> <span class="token keyword">if</span><span class="token punctuation">(</span>sex <span class="token operator">=</span><span class="token string">'f'</span><span class="token punctuation">,</span><span class="token string">'m'</span><span class="token punctuation">,</span><span class="token string">'f'</span><span class="token punctuation">)</span> 
<span class="token comment">--  swap f to m and m to f in sex column</span>
<span class="token keyword">COMMIT</span>
<span class="token keyword">END</span> TRY
<span class="token keyword">BEGIN</span> CATCH
<span class="token keyword">ROLLBACK</span>
<span class="token keyword">END</span> CATCH
</code></pre>
<h2 id="sql-variables">SQL Variables<a aria-hidden="true" class="anchor-heading icon-link" href="#sql-variables"></a></h2>
<p>If we want to use a variable in SQL Server, we have to declare it using <code>DECLARE</code> statement.</p>
<p>Local variable names have to start with an at (@) sign.</p>
<ul>
<li>declaring variables</li>
</ul>
<pre class="language-sql"><code class="language-sql"><span class="token keyword">DECLARE</span> <span class="token variable">@TestVariable</span> <span class="token keyword">AS</span> <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span>
<span class="token keyword">DECLARE</span> <span class="token variable">@TestVariable</span> <span class="token comment">-- NULL initialization</span>
</code></pre>
<ul>
<li>assign values to variables</li>
</ul>
<pre class="language-sql"><code class="language-sql"><span class="token keyword">SELECT</span> <span class="token variable">@TestVariable</span> <span class="token operator">=</span> <span class="token string">'Save the Nature'</span> <span class="token comment">--single select line</span>

<span class="token comment">--- ASSIGN LAST VALUE OF TABLE T</span>
<span class="token keyword">select</span> <span class="token variable">@TestVariable</span> <span class="token operator">=</span> person_name
<span class="token keyword">from</span> t
<span class="token keyword">where</span> salary <span class="token operator">=</span> <span class="token number">100000</span>
</code></pre>
<ul>
<li>assign variable value using set</li>
</ul>
<pre class="language-sql"><code class="language-sql"><span class="token keyword">DECLARE</span> <span class="token variable">@Variable1</span> <span class="token keyword">AS</span> <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span>
<span class="token keyword">DECLARE</span> <span class="token variable">@Variable2</span> <span class="token keyword">AS</span> UNIQUEIDENTIFIER
<span class="token keyword">SET</span> <span class="token variable">@Variable1</span> <span class="token operator">=</span> <span class="token string">'Save Water Save Life'</span>
<span class="token keyword">SET</span> <span class="token variable">@Variable2</span><span class="token operator">=</span> <span class="token string">'6D8446DE-68DA-4169-A2C5-4C0995C00CC1'</span>
</code></pre>
<ul>
<li>assign many varaibles to values</li>
</ul>
<pre class="language-sql"><code class="language-sql"><span class="token keyword">DECLARE</span> <span class="token variable">@Variable1</span> <span class="token keyword">AS</span> <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token variable">@Variable2</span> <span class="token keyword">AS</span> UNIQUEIDENTIFIER
<span class="token keyword">SELECT</span> <span class="token variable">@Variable1</span> <span class="token operator">=</span> <span class="token string">'Save Water Save Life'</span> <span class="token punctuation">,</span> <span class="token variable">@Variable2</span><span class="token operator">=</span> <span class="token string">'6D8446DE-68DA-4169-A2C5-4C0995C00CC1'</span>
</code></pre>
<ul>
<li>end of batch, <code>GO</code> keyword</li>
</ul>
<pre class="language-sql"><code class="language-sql"><span class="token keyword">DECLARE</span> <span class="token variable">@TestVariable</span> <span class="token keyword">AS</span> <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span>
<span class="token keyword">SET</span> <span class="token variable">@TestVariable</span> <span class="token operator">=</span> <span class="token string">'Think Green'</span>
GO
<span class="token keyword">PRINT</span> <span class="token variable">@TestVariable</span> <span class="token comment">-- ERROR, varibale not declared</span>
</code></pre>
<ul>
<li>PREPARE, EXECUTE and DEALLOCATE statement in MySQL</li>
<li>running strings as statements</li>
</ul>
<pre class="language-sql"><code class="language-sql"><span class="token keyword">SET</span> <span class="token variable">@s</span> <span class="token operator">=</span> <span class="token string">'SELECT ? + ? AS sumtable'</span><span class="token punctuation">;</span>
<span class="token keyword">PREPARE</span> stmt1 <span class="token keyword">FROM</span> <span class="token variable">@s</span><span class="token punctuation">;</span>
<span class="token keyword">SET</span> <span class="token variable">@a</span> <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">;</span>
<span class="token keyword">SET</span> <span class="token variable">@b</span> <span class="token operator">=</span> <span class="token number">6</span><span class="token punctuation">;</span>
<span class="token keyword">EXECUTE</span> stmt1 <span class="token keyword">USING</span> <span class="token variable">@a</span><span class="token punctuation">,</span> <span class="token variable">@b</span><span class="token punctuation">;</span>
<span class="token keyword">DEALLOCATE</span> <span class="token keyword">PREPARE</span> stmt1<span class="token punctuation">;</span>
</code></pre>
<p>this would return</p>
<pre><code>+----------+
| sumtable |
+----------+
|       10 |
+----------+
</code></pre>
<h2 id="sql-cte">SQL CTE<a aria-hidden="true" class="anchor-heading icon-link" href="#sql-cte"></a></h2>
<p>CTE = Common Table Expression. These are temporary tables which act as variable that you can use through your code.
<a href="https://leetcode.com/problems/change-null-values-in-a-table-to-the-previous-value/submissions/">Example problem</a></p>
<pre class="language-sql"><code class="language-sql"><span class="token keyword">with</span> cte <span class="token keyword">as</span> <span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token operator">*</span><span class="token punctuation">,</span>rank<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">over</span><span class="token punctuation">(</span><span class="token keyword">order</span> <span class="token keyword">by</span> money<span class="token punctuation">)</span> <span class="token keyword">as</span> r <span class="token keyword">from</span> t<span class="token punctuation">)</span><span class="token punctuation">,</span>
     cte2 <span class="token keyword">as</span> <span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token operator">*</span><span class="token punctuation">,</span><span class="token function">min</span><span class="token punctuation">(</span>r<span class="token punctuation">)</span> <span class="token keyword">as</span> minn <span class="token keyword">from</span> cte2<span class="token punctuation">)</span><span class="token punctuation">,</span>
     cte3 <span class="token keyword">as</span> <span class="token punctuation">(</span><span class="token keyword">select</span> student <span class="token keyword">from</span> cte2 <span class="token keyword">where</span> r <span class="token operator">=</span> minn<span class="token punctuation">)</span>
<span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> cte3
</code></pre>
<p>Avoid running lots of subqueries, joining, carrying tables around!</p>
<h2 id="sql-recursion">SQL recursion<a aria-hidden="true" class="anchor-heading icon-link" href="#sql-recursion"></a></h2>
<p>Basic SQL cannot express unbounded computations.</p>
<p>Table: ParentOf</p>
<pre><code>Parent |  Child
Sue    |  Mary
Bob    |  Mary
Fred   |  Bob
Jane   |  Bob
</code></pre>
<p>Tasks: Find Parent, Grandparent (two instances of ParentOf), Grand-grand parent(three instances of ParentOf)
Note you need recursion</p>
<p><code>With</code> construct exists in SQL by itself. It often used to have recursion in SQL.</p>
<p><img src="/dendron-wiki/assets/images/with_statement.png" alt="with_statement.png" style="width:600px;"></p>
<p>each relation R is the result of its corresponding query. Final result of the master LAST query. Can thing of <code>AS</code> to be an
assignment for the realtions</p>
<p>We can specify recursive statements using the <code>Recursive</code> keyword after <code>With</code></p>
<pre class="language-sql"><code class="language-sql"><span class="token keyword">WITH</span> RECURSIVE cte_name <span class="token keyword">AS</span> <span class="token punctuation">(</span>
    initial_query  <span class="token comment">-- anchor member</span>
    <span class="token keyword">UNION</span> <span class="token keyword">ALL</span>
    recursive_query <span class="token comment">-- recursive member that references to the CTE name</span>
<span class="token punctuation">)</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> cte_name<span class="token punctuation">;</span>
</code></pre>
<pre class="language-sql"><code class="language-sql"><span class="token keyword">WITH</span> RECURSIVE cte_count
<span class="token keyword">AS</span> <span class="token punctuation">(</span>
      <span class="token keyword">SELECT</span> <span class="token number">1</span> <span class="token keyword">as</span> n<span class="token comment">-- BASE CASE</span>
      <span class="token keyword">UNION</span> <span class="token keyword">ALL</span> <span class="token comment"># might enter infinite loop, careful</span>
      <span class="token keyword">SELECT</span> n <span class="token operator">+</span> <span class="token number">1</span>
      <span class="token keyword">FROM</span> cte_count <span class="token comment">-- Recursive call, should dependt on the relation itself CTE_COUNT!</span>
      <span class="token keyword">WHERE</span> n <span class="token operator">&#x3C;</span> <span class="token number">3</span>
    <span class="token punctuation">)</span>
<span class="token keyword">SELECT</span> n
<span class="token keyword">FROM</span> cte_count<span class="token punctuation">;</span>
</code></pre>
<p><img src="/dendron-wiki/assets/images/recursion_example.png" alt="recursion_example.png" style="width:600px;"></p>
<ul>
<li>generate consecutive numbers</li>
</ul>
<pre class="language-sql"><code class="language-sql"><span class="token keyword">WITH</span> RECURSIVE seq <span class="token keyword">AS</span> <span class="token punctuation">(</span>
    <span class="token keyword">SELECT</span> <span class="token number">0</span> <span class="token keyword">AS</span> <span class="token keyword">value</span> <span class="token keyword">UNION</span> <span class="token keyword">ALL</span> <span class="token keyword">SELECT</span> <span class="token keyword">value</span> <span class="token operator">+</span> <span class="token number">1</span> <span class="token keyword">FROM</span> seq <span class="token keyword">WHERE</span> <span class="token keyword">value</span> <span class="token operator">&#x3C;</span> <span class="token number">100</span>
    <span class="token punctuation">)</span>

<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> seq<span class="token punctuation">;</span>
</code></pre>
<ul>
<li>with statement <a href="https://leetcode.com/problems/the-number-of-seniors-and-juniors-to-join-the-company/">leetcode</a>
Basic SQL cannot express unbounded computations. WITH construct is available in SQL without recursion. But this is the construct used to ADD recursion in SQL. CTE = common table expression. WITH is like a function in SQL</li>
</ul>
<pre class="language-sql"><code class="language-sql"><span class="token keyword">with</span> R1 <span class="token keyword">as</span> <span class="token punctuation">(</span>query <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
     R2 <span class="token keyword">as</span> <span class="token punctuation">(</span>query <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
     <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
     CTE <span class="token keyword">as</span> <span class="token punctuation">(</span>query<span class="token punctuation">)</span><span class="token punctuation">,</span>
     
 <span class="token operator">&#x3C;</span>query involving <span class="token keyword">all</span> R1<span class="token punctuation">,</span> R2 <span class="token punctuation">.</span><span class="token punctuation">.</span>Rn<span class="token punctuation">,</span> CTE <span class="token operator">+</span> other <span class="token keyword">tables</span><span class="token operator">></span> <span class="token comment"># return this last query</span>
</code></pre>
<ul>
<li>recursion</li>
</ul>
<pre class="language-sql"><code class="language-sql"><span class="token keyword">WITH</span> RECURSIVE cte_name <span class="token keyword">AS</span> <span class="token punctuation">(</span>
    cte_query_definition <span class="token punctuation">(</span>the anchor member<span class="token punctuation">)</span>

    <span class="token keyword">UNION</span> <span class="token keyword">ALL</span>

    cte_query_definition <span class="token punctuation">(</span>the recursive member<span class="token punctuation">)</span> <span class="token comment"># often need where statement to stop</span>
<span class="token punctuation">)</span>

 
<span class="token keyword">SELECT</span> <span class="token operator">*</span>
<span class="token keyword">FROM</span>   cte_name<span class="token punctuation">;</span>
</code></pre>
<p><img src="/dendron-wiki/assets/images/recursion_query.png" alt="recursion_query.png"></p>
<p><img src="/dendron-wiki/assets/images/recursion.png" alt="recursion.png"></p>
<ul>
<li>classic family tree recursion <a href="https://leetcode.com/problems/all-people-report-to-the-given-manager/">problem</a></li>
</ul>
<h2 id="sql-indexing">SQL indexing<a aria-hidden="true" class="anchor-heading icon-link" href="#sql-indexing"></a></h2>
<p><a href="https://www.youtube.com/watch?v=Y7Qlc7f_u0o">Stanford Lecture</a></p>
<p>Index column B and you can ask questions such as show me the rows where elements in column B belong to certain interval
is going to be faster.</p>
<p><img src="/dendron-wiki/assets/images/indexing.png" alt="indexing.png" style="width:600px;"></p>
<p>Users don't access indexes! They are used underneath by the query execution engine.</p>
<p>Underlying data structures = type of indexes:</p>
<ul>
<li>hash allows only concrete checks such as table.A = val <strong>O(1)</strong></li>
<li>B+ trees allows checks such as table.A = val, v1 &#x3C; table.A &#x3C;= v2 <strong>O(log(n))</strong></li>
<li>R+ trees</li>
</ul>
<p>No indexes is <strong>O(n)</strong> time
Many DBMS's build indexes automatically on <code>PRIMARY KEY</code> (and sometimes <code>UNIQUE</code>) attributes.</p>
<p>Examples:</p>
<pre class="language-sql"><code class="language-sql"><span class="token keyword">select</span> student_id
<span class="token keyword">from</span> student
<span class="token keyword">where</span> student_name <span class="token operator">=</span> <span class="token string">'Kuny'</span> <span class="token operator">and</span> gpa <span class="token operator">></span> <span class="token number">3.9</span>
</code></pre>
<ul>
<li>index on student_name (hash-based index)</li>
<li>index on gpa (tree-based)</li>
<li>index on (student_name,gpa)</li>
</ul>
<pre class="language-sql"><code class="language-sql"><span class="token keyword">select</span> s_name<span class="token punctuation">,</span> c_name
<span class="token keyword">from</span> student<span class="token punctuation">,</span> <span class="token keyword">apply</span>
<span class="token keyword">where</span> student<span class="token punctuation">.</span>s_id <span class="token operator">=</span> <span class="token keyword">apply</span><span class="token punctuation">.</span>s_id
</code></pre>
<ul>
<li>no indexing is <code>O(m*n)</code></li>
<li>index student.s_id -> <code>O(n)</code></li>
<li>index apply.s_id -> <code>O(m)</code></li>
</ul>
<p>Downsides of indexes:</p>
<ul>
<li>extra space (persistent data structure stored underneath the database) = marginal downside (ok-ish)</li>
<li>index created = medium downside/initialization can be slow</li>
<li>index maintenance, can offset benefits. If we modify often the const of maintaining the indexes (re-initialization)
can be quite expensive. If you do lots of writes and less reads better not use indexes.</li>
</ul>
<pre class="language-sql"><code class="language-sql"><span class="token keyword">create</span> <span class="token keyword">index</span> your_index_name <span class="token keyword">on</span> your_table_name<span class="token punctuation">(</span>your_column_name<span class="token punctuation">)</span> <span class="token keyword">using</span> <span class="token keyword">HASH</span><span class="token punctuation">;</span>
<span class="token operator">or</span>
<span class="token keyword">create</span> <span class="token keyword">index</span> your_index_name <span class="token keyword">on</span> your_table_name<span class="token punctuation">(</span>your_column_name<span class="token punctuation">)</span> <span class="token keyword">using</span> <span class="token keyword">BTREE</span><span class="token punctuation">;</span>
</code></pre>
<p>The best way to improve the performance of SELECT operations is to create indexes on one or more of the columns that are tested in the query. The index entries act like pointers to the table rows, allowing the query to quickly determine which rows match a condition in the WHERE clause, and retrieve the other column values for those rows. All MySQL data types can be indexed.
Indexes are used to find rows with specific column values quickly. Without an index, MySQL must begin with the first row
and then read through the entire table to find the relevant rows.</p>
<ul>
<li>index columns used in <code>WHERE</code> clauses</li>
</ul>
<p><strong>Column Indexes</strong>
The most common type of index involves a single column, storing copies of the values from that column in a data structure, allowing fast lookups for the rows with the corresponding column values. The B-tree data structure lets the index quickly find a specific value, a set of values, or a range of values, corresponding to operators such as<code> =, >, ≤, BETWEEN, IN,</code> and so on, in a <code>WHERE</code> clause.</p>
<h2 id="database-design">Database design<a aria-hidden="true" class="anchor-heading icon-link" href="#database-design"></a></h2>
<ol>
<li>
<p>Understand the Data – Is it relational or document-based? Do you need to manage complex queries or just store simple key-value pairs?</p>
</li>
<li>
<p>Scalability Is Key – High traffic? Complex joins?</p>
</li>
<li>
<p>Consistency vs. Performance – Do you need strong consistency (ACID) or can you tolerate eventual consistency for better availability and partition tolerance? </p>
</li>
<li>
<p>Account for Future Evolution  – Can your database scale? Is it flexible enough for new features?</p>
</li>
<li>
<p>Keep It Simple</p>
</li>
</ol>
<p><a href="https://www.youtube.com/watch?v=DFnAakJ4FDg&#x26;list=PL9ysvtVnryGpnIj9rcIqNDxakUn6v72Hm&#x26;index=31">Design by decomposition</a></p>
<ul>
<li>start with 'mega' relations containing everything</li>
<li>decompose into smaller, better relations with same info</li>
<li>can do decomosition automatically
<strong>Final set of relations satisfies normal form</strong> (normalization of a database) = no redundant data, updates are easier to be made.</li>
</ul>
<p>Denormalised database example:</p>
<pre class="language-sql"><code class="language-sql"><span class="token keyword">Apply</span><span class="token punctuation">(</span>SSN<span class="token punctuation">,</span> student_name<span class="token punctuation">,</span> college_name<span class="token punctuation">,</span> high_school<span class="token punctuation">,</span> city<span class="token punctuation">,</span> hobby<span class="token punctuation">)</span>
</code></pre>
<p><em>Apply</em> is a table with all columns (ssn = social security number) stored in one place.
To record Ann with SSN = 123 from Sofia, studied at SMG and 125, plays tennis and trumpet and applied at Stanford, Berkeley, MIT
we need 12 different rows! Studied at SMG will be repeated 6 times, applied at MIT will be repeated 4 times.
<strong>Redundancy</strong> in the database.</p>
<p>Normalised database:</p>
<pre><code>Student(SSN, student_name)
Apply(SSN, college_name)
HighSchool(SSN, high_school)
Located(high_school, city)
Hobbies(SSN, hobby)
</code></pre>
<p>Decide how to normalize your database by looking for:</p>
<ul>
<li>functional dependencies</li>
<li>multivalued dependencies</li>
</ul>
<p><em>Buzz word</em> If you see Functional Dependency  use Boyce-Codd Normal Form (decompose your table)</p>
<p><img src="/dendron-wiki/assets/images/functional_dep.png" alt="functional_dep.png" style="width:600px;"></p>
<p><em>Buzz word</em> If you see multivalued Dependency  use Boyce-Codd Normal Form (decompose your table)</p>
<p><img src="/dendron-wiki/assets/images/multivalued_dep.png" alt="multivalued_dep.png" style="width:600px;"></p>
<p>Maybe check this <a href="https://www.youtube.com/watch?v=GFQaEYEc8_8&#x26;ab_channel=Decomplexify">youtube</a></p>
<h2 id="orm">ORM<a aria-hidden="true" class="anchor-heading icon-link" href="#orm"></a></h2>
<p>SQL Alchemy</p>
<p>ORM</p>
<p>Relational Map, e.g. from SQL to Python</p>
<p>leaky/soft abstraction</p>
<h1 id="problems">Problems<a aria-hidden="true" class="anchor-heading icon-link" href="#problems"></a></h1>
<p><a href="https://leetcode.com/problems/find-the-start-and-end-number-of-continuous-ranges/">1285</a>
<a href="https://leetcode.com/problems/nth-highest-salary/">177</a>
<a href="https://leetcode.com/problems/find-median-given-frequency-of-numbers/submissions/">571</a>
<a href="https://leetcode.com/problems/biggest-window-between-visits/">1709</a>
<a href="https://leetcode.com/problems/all-people-report-to-the-given-manager/">1270</a>
<a href="https://leetcode.com/problems/find-the-missing-ids/">1613</a>
<a href="https://leetcode.com/problems/median-employee-salary/">569</a>
<a href="https://leetcode.com/problems/tree-node/submissions/">608</a>
<a href="https://leetcode.com/problems/arrange-table-by-gender/">2308</a>
<a href="https://leetcode.com/problems/users-with-two-purchases-within-seven-days/">2228</a>
<a href="https://leetcode.com/problems/find-the-start-and-end-number-of-continuous-ranges/submissions/">1285</a>
<a href="https://leetcode.com/problems/get-the-second-most-recent-activity/">1369</a></p>
<h1 id="topics">Topics<a aria-hidden="true" class="anchor-heading icon-link" href="#topics"></a></h1>
<p>Space and Time Complexity intro to Queries: <a href="https://medium.com/learning-data/understanding-algorithmic-time-efficiency-in-sql-queries-616176a85d02">https://medium.com/learning-data/understanding-algorithmic-time-efficiency-in-sql-queries-616176a85d02</a><br>
Basic (important!) Query Optimisation Techniques: <a href="https://medium.com/learning-sql/12-tips-for-optimizing-sql-queries-for-faster-performance-8c6c092d7af1">https://medium.com/learning-sql/12-tips-for-optimizing-sql-queries-for-faster-performance-8c6c092d7af1</a><br>
Advanced Topics in SQL: <a href="https://sqlpad.io/tutorial/advanced-sql/">https://sqlpad.io/tutorial/advanced-sql/</a>  </p>
<ul>
<li>UNION, GROU[ BY (UNDERSTAND HOW IT WORKS), INDEXATION, PARTITION<br>
B-TREE: <a href="https://builtin.com/data-science/b-tree-index">https://builtin.com/data-science/b-tree-index</a> (fundamental Database data structure! - connection to indexing!)  </li>
</ul></div></div><div style="padding-left:10px;padding-right:10px" class="ant-col ant-col-xs-0 ant-col-md-6"><div><div class=""><div class="ant-anchor-wrapper dendron-toc" style="max-height:calc(100vh - 64px);z-index:1"><div class="ant-anchor"><div class="ant-anchor-ink"><span class="ant-anchor-ink-ball"></span></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#buzzwords" title="Buzzwords">Buzzwords</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#code-snippets" title="Code snippets">Code snippets</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#sql-variables" title="SQL Variables">SQL Variables</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#sql-cte" title="SQL CTE">SQL CTE</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#sql-recursion" title="SQL recursion">SQL recursion</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#sql-indexing" title="SQL indexing">SQL indexing</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#database-design" title="Database design">Database design</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#orm" title="ORM">ORM</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#problems" title="Problems">Problems</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#topics" title="Topics">Topics</a></div></div></div></div></div></div></div></div></div></div></div><div class="ant-divider ant-divider-horizontal" role="separator"></div><footer class="ant-layout-footer" style="padding:0 24px 24px"></footer></main></section></section></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"note":{"id":"sbumi7y73tummx1u7z1vo6s","title":"SQL","desc":"","updated":1749555121529,"created":1658698294975,"custom":{},"fname":"engineering.SQL","type":"note","vault":{"fsPath":"vault"},"contentHash":"335ad3d65ffc06a4cf35c72f9eadc472","links":[],"anchors":{"buzzwords":{"type":"header","text":"Buzzwords","value":"buzzwords","line":9,"column":0,"depth":1},"code-snippets":{"type":"header","text":"Code snippets","value":"code-snippets","line":16,"column":0,"depth":1},"sql-variables":{"type":"header","text":"SQL Variables","value":"sql-variables","line":439,"column":0,"depth":2},"sql-cte":{"type":"header","text":"SQL CTE","value":"sql-cte","line":505,"column":0,"depth":2},"sql-recursion":{"type":"header","text":"SQL recursion","value":"sql-recursion","line":521,"column":0,"depth":2},"sql-indexing":{"type":"header","text":"SQL indexing","value":"sql-indexing","line":613,"column":0,"depth":2},"database-design":{"type":"header","text":"Database design","value":"database-design","line":675,"column":0,"depth":2},"orm":{"type":"header","text":"ORM","value":"orm","line":728,"column":0,"depth":2},"problems":{"type":"header","text":"Problems","value":"problems","line":740,"column":0,"depth":1},"topics":{"type":"header","text":"Topics","value":"topics","line":754,"column":0,"depth":1}},"children":[],"parent":"6bx5plramu4hksomqc1n55z","data":{}},"body":"\u003ch1 id=\"sql\"\u003eSQL\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#sql\"\u003e\u003c/a\u003e\u003c/h1\u003e\n\u003cp\u003eMost notes here are from \u003ca href=\"https://www.youtube.com/watch?v=Yceqbp_DKbA\u0026#x26;list=PL9ysvtVnryGpnIj9rcIqNDxakUn6v72Hm\u0026#x26;index=103\"\u003eStanford lectures\u003c/a\u003e and leetcode.\u003c/p\u003e\n\u003ch1 id=\"buzzwords\"\u003eBuzzwords\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#buzzwords\"\u003e\u003c/a\u003e\u003c/h1\u003e\n\u003cp\u003erelational algebra, relational data model, relational database, DBMS (database management system), PostgreSQL, MySQL, declarative, power of set theory, projection, persistent data (outlives program), schema (type) vs data(variables), DDL (data definition language) used to set up schema, DML (data manipulation language = query language), database = set of named relations, relation = table, columns = attributes of relation, rows = tuple, schema = structural description of relations in database, ACID properties, select = project operator, cross product, join, inner, outer, left, right, union, join = cross product + where, CTE = common table expression, subquery, normalization, denormalization, sharding, shards, transactions\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eSQL is declarative - you say \"what\" you want but not how you want it\u003c/li\u003e\n\u003cli\u003eSQL is not \"Turing complete\" = computationally universal (can do all stuff)\u003c/li\u003e\n\u003cli\u003ebasic SQL cannot run unbounded computations (no for loops)\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch1 id=\"code-snippets\"\u003eCode snippets\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#code-snippets\"\u003e\u003c/a\u003e\u003c/h1\u003e\n\u003cul\u003e\n\u003cli\u003ejoin\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre class=\"language-sql\"\u003e\u003ccode class=\"language-sql\"\u003e\u003cspan class=\"token keyword\"\u003eselect\u003c/span\u003e \u003cspan class=\"token operator\"\u003e*\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003efrom\u003c/span\u003e table1 t1\n\u003cspan class=\"token keyword\"\u003eleft\u003c/span\u003e \u003cspan class=\"token keyword\"\u003ejoin\u003c/span\u003e table2 t2\n\u003cspan class=\"token keyword\"\u003eon\u003c/span\u003e t1\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eid \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e t2\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eid\n\n\u003cspan class=\"token keyword\"\u003eselect\u003c/span\u003e \u003cspan class=\"token operator\"\u003e*\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003efrom\u003c/span\u003e t1\n\u003cspan class=\"token keyword\"\u003eleft\u003c/span\u003e \u003cspan class=\"token keyword\"\u003ejoin\u003c/span\u003e t2 \u003cspan class=\"token keyword\"\u003eusing\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eproduct_id\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cul\u003e\n\u003cli\u003eno full outer join in MySQL. Emulate it by:\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre class=\"language-sql\"\u003e\u003ccode class=\"language-sql\"\u003e\u003cspan class=\"token keyword\"\u003eSELECT\u003c/span\u003e \u003cspan class=\"token operator\"\u003e*\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eFROM\u003c/span\u003e t1\n\u003cspan class=\"token keyword\"\u003eLEFT\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eJOIN\u003c/span\u003e t2 \u003cspan class=\"token keyword\"\u003eON\u003c/span\u003e t1\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eid \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e t2\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eid\n\u003cspan class=\"token keyword\"\u003eUNION\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003eSELECT\u003c/span\u003e \u003cspan class=\"token operator\"\u003e*\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eFROM\u003c/span\u003e t1\n\u003cspan class=\"token keyword\"\u003eRIGHT\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eJOIN\u003c/span\u003e t2 \u003cspan class=\"token keyword\"\u003eON\u003c/span\u003e t1\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eid \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e t2\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eid\n\u003c/code\u003e\u003c/pre\u003e\n\u003cul\u003e\n\u003cli\u003ejoin on operations \u003ca href=\"https://leetcode.com/problems/leetflex-banned-accounts/\"\u003eleetcode\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre\u003e\u003ccode\u003esometimes is smart to do joins on operations/conditions\njoin on t1.id = t2.id-1\n\u003c/code\u003e\u003c/pre\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003ejoin is just a cross product with where statements\u003c/strong\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003econditional statement case when else end\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre class=\"language-sql\"\u003e\u003ccode class=\"language-sql\"\u003e\u003cspan class=\"token keyword\"\u003eselect\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token keyword\"\u003ecase\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003ewhen\u003c/span\u003e condition1 \u003cspan class=\"token keyword\"\u003ethen\u003c/span\u003e result1\n    \u003cspan class=\"token keyword\"\u003ewhen\u003c/span\u003e condition2 \u003cspan class=\"token keyword\"\u003ethen\u003c/span\u003e result2\n    \u003cspan class=\"token keyword\"\u003ewhen\u003c/span\u003e conditionN \u003cspan class=\"token keyword\"\u003ethen\u003c/span\u003e resultN\n    \u003cspan class=\"token keyword\"\u003eelse\u003c/span\u003e result \u003cspan class=\"token comment\"\u003e# else can be dropped too\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003eend\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eas\u003c/span\u003e field\n\u003cspan class=\"token keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"token keyword\"\u003etable\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cul\u003e\n\u003cli\u003eif conditional statement\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre class=\"language-sql\"\u003e\u003ccode class=\"language-sql\"\u003e\u003cspan class=\"token keyword\"\u003eselect\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eif\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003econdition\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e true_val\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e false_val\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eas\u003c/span\u003e field\n\u003cspan class=\"token keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"token keyword\"\u003etable\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cul\u003e\n\u003cli\u003eleast, greatest to take min,max of a row \u003ca href=\"https://leetcode.com/problems/number-of-calls-between-two-persons/\"\u003eleetcode\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre class=\"language-sql\"\u003e\u003ccode class=\"language-sql\"\u003e\u003cspan class=\"token keyword\"\u003eselect\u003c/span\u003e least\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003efrom_id\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003eto_id\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eas\u003c/span\u003e person1\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e greatest\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003efrom_id\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003eto_id\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eas\u003c/span\u003e person2\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n        \u003cspan class=\"token function\"\u003ecount\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token operator\"\u003e*\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eas\u003c/span\u003e call_count\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token function\"\u003esum\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eduration\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eas\u003c/span\u003e total_duration\n\u003cspan class=\"token keyword\"\u003efrom\u003c/span\u003e calls\n\u003cspan class=\"token keyword\"\u003egroup\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eby\u003c/span\u003e person1\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003eperson2\n\u003c/code\u003e\u003c/pre\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003epartition by \u003ca href=\"https://leetcode.com/problems/find-the-quiet-students-in-all-exams/discuss/1414605/Become-the-Master-of-Partition-By\"\u003eleetcode\u003c/a\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003ewindow question \u003ca href=\"https://leetcode.com/problems/biggest-window-between-visits/\"\u003eleetcode\u003c/a\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003edate operations\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre class=\"language-sql\"\u003e\u003ccode class=\"language-sql\"\u003e\u003cspan class=\"token keyword\"\u003eselect\u003c/span\u003e \n        datediff\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003edate1\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003edate2\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eas\u003c/span\u003e diff\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token comment\"\u003e-- measred in days\u003c/span\u003e\n        period_diff\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e'202210'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\u003cspan class=\"token string\"\u003e'202301'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eas\u003c/span\u003e diff\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token comment\"\u003e-- measured in months\u003c/span\u003e\n        \u003cspan class=\"token keyword\"\u003emonth\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003edate1\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eas\u003c/span\u003e \u003cspan class=\"token keyword\"\u003emonth\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n        date_add\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e'2018-05-01'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\u003cspan class=\"token keyword\"\u003eINTERVAL\u003c/span\u003e \u003cspan class=\"token number\"\u003e1\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eDAY\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eas\u003c/span\u003e next_day\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n        dayofweek\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e'2007-02-03'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eas\u003c/span\u003e day_of_week \u003cspan class=\"token comment\"\u003e# 1 to 7 (1 and 7 are weekend)\u003c/span\u003e\n        dayofyear\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e'2007-02-03'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eas\u003c/span\u003e day_of_week\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n        to_days\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e'2008-01-01'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eas\u003c/span\u003e date_number\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n        date_format\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token keyword\"\u003edate\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\u003cspan class=\"token string\"\u003e'%d/%m/%Y'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eas\u003c/span\u003e formatted_date\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n        least\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e'2018-12-31'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\u003cspan class=\"token keyword\"\u003edate\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n        greatest\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ed1\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003ed2\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cul\u003e\n\u003cli\u003edate_part, date operations in postgresql - give PART of the DATE\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://leetcode.com/problems/tasks-count-in-the-weekend/\"\u003eleetcode\u003c/a\u003e you can test your functions here\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre class=\"language-sql\"\u003e\u003ccode class=\"language-sql\"\u003e\u003cspan class=\"token keyword\"\u003eselect\u003c/span\u003e \nDATE_PART\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e'field'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e column_name\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token comment\"\u003e-- need to use these quotation marks ''\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003eSELECT\u003c/span\u003e DATE_PART\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e'year'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eTIMESTAMP\u003c/span\u003e \u003cspan class=\"token string\"\u003e'2024-07-06 15:23:10'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e    \u003cspan class=\"token comment\"\u003e-- 2024\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003eSELECT\u003c/span\u003e DATE_PART\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e'day'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eDATE\u003c/span\u003e \u003cspan class=\"token string\"\u003e'2024-07-06'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e                   \u003cspan class=\"token comment\"\u003e-- 6\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003eSELECT\u003c/span\u003e DATE_PART\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e'month'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token function\"\u003enow\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e                             \u003cspan class=\"token comment\"\u003e-- current month as number\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003eSELECT\u003c/span\u003e DATE_PART\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e'dow'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eDATE\u003c/span\u003e \u003cspan class=\"token string\"\u003e'2024-07-06'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e                   \u003cspan class=\"token comment\"\u003e-- 6 (Saturday, 0 = Sunday)\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003efrom\u003c/span\u003e t\n\u003c/code\u003e\u003c/pre\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003efield\u003c/code\u003e can be 'year', 'month', 'day', 'dow', 'hour', 'minute', 'second'\u003c/li\u003e\n\u003cli\u003e'dow' gives a number where 0 is Sunday and 6 is Saturday\u003c/li\u003e\n\u003c/ul\u003e\n\u003cul\u003e\n\u003cli\u003edate_trunc truncates the date column to the specified precision (beginning of month, year and so on)\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre class=\"language-sql\"\u003e\u003ccode class=\"language-sql\"\u003e\u003cspan class=\"token keyword\"\u003eSELECT\u003c/span\u003e DATE_TRUNC\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e'month'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eTIMESTAMP\u003c/span\u003e \u003cspan class=\"token string\"\u003e'2024-07-06 15:23:10'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e   \u003cspan class=\"token comment\"\u003e-- '2024-07-01 00:00:00'\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003eSELECT\u003c/span\u003e DATE_TRUNC\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e'day'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eTIMESTAMP\u003c/span\u003e \u003cspan class=\"token string\"\u003e'2024-07-06 15:23:10'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e     \u003cspan class=\"token comment\"\u003e-- '2024-07-06 00:00:00'\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003eSELECT\u003c/span\u003e DATE_TRUNC\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e'year'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token function\"\u003enow\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e                              \u003cspan class=\"token comment\"\u003e-- start of this year\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003eTIMESTAMP, DATE, INTERVAL . they all convert string to date-like object\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eINTERVAL represents a unit of time that can be added or subtracted from dates\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre class=\"language-sql\"\u003e\u003ccode class=\"language-sql\"\u003e\u003cspan class=\"token keyword\"\u003eINTERVAL\u003c/span\u003e \u003cspan class=\"token string\"\u003e'N unit'\u003c/span\u003e \u003cspan class=\"token comment\"\u003e-- unit can be 'day', 'days', 'month', 'week', 'hour' etc\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre class=\"language-sql\"\u003e\u003ccode class=\"language-sql\"\u003e\u003cspan class=\"token keyword\"\u003eSELECT\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eTIMESTAMP\u003c/span\u003e \u003cspan class=\"token string\"\u003e'2025-05-01 15:45:01'\u003c/span\u003e \u003cspan class=\"token operator\"\u003e+\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eINTERVAL\u003c/span\u003e \u003cspan class=\"token string\"\u003e'10 minutes'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003eTIMESTAMP\u003c/span\u003e \u003cspan class=\"token string\"\u003e'2025-05-01 15:45:01'\u003c/span\u003e \u003cspan class=\"token operator\"\u003e-\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eINTERVAL\u003c/span\u003e \u003cspan class=\"token string\"\u003e'10 minute'\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eas\u003c/span\u003e a\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003eTIMESTAMP\u003c/span\u003e \u003cspan class=\"token string\"\u003e'2025-05-01 15:45:01'\u003c/span\u003e \u003cspan class=\"token operator\"\u003e+\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eINTERVAL\u003c/span\u003e \u003cspan class=\"token string\"\u003e'1 week'\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eas\u003c/span\u003e b\n\u003c/code\u003e\u003c/pre\u003e\n\u003cul\u003e\n\u003cli\u003ecasting in postgreSQL\u003c/li\u003e\n\u003c/ul\u003e\n\u003col\u003e\n\u003cli\u003e\n\u003cp\u003eUse ::typename or CAST(value AS typename)\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eIf in doubt, cast explicitly.\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003cpre class=\"language-sql\"\u003e\u003ccode class=\"language-sql\"\u003e\u003cspan class=\"token keyword\"\u003eSELECT\u003c/span\u003e \u003cspan class=\"token string\"\u003e'2023-08-16'\u003c/span\u003e::\u003cspan class=\"token keyword\"\u003edate\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e                 \u003cspan class=\"token comment\"\u003e-- 2023-08-16\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003eSELECT\u003c/span\u003e \u003cspan class=\"token string\"\u003e'2023-08-16 15:20'\u003c/span\u003e::\u003cspan class=\"token keyword\"\u003etimestamp\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e      \u003cspan class=\"token comment\"\u003e-- 2023-08-16 15:20:00\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003eSELECT\u003c/span\u003e \u003cspan class=\"token string\"\u003e'123'\u003c/span\u003e::\u003cspan class=\"token keyword\"\u003einteger\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e       \u003cspan class=\"token comment\"\u003e-- 123 (text to int)\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003eSELECT\u003c/span\u003e \u003cspan class=\"token number\"\u003e123\u003c/span\u003e::\u003cspan class=\"token keyword\"\u003etext\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e            \u003cspan class=\"token comment\"\u003e-- '123' (int to text)\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cul\u003e\n\u003cli\u003ewidth_bucket\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre class=\"language-sql\"\u003e\u003ccode class=\"language-sql\"\u003e\u003cspan class=\"token keyword\"\u003eselect\u003c/span\u003e width_bucket\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ecolumn_name\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e min_value\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e max_value\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e number_of_buckets\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token comment\"\u003e-- max_value is the upper bound of the last bucket non-exclusive [)\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003eselect\u003c/span\u003e width_bucket\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003escore\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token number\"\u003e1\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token number\"\u003e101\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token number\"\u003e5\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token comment\"\u003e-- 5 buckets [1,20], [21- 40] ... \u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cul\u003e\n\u003cli\u003esubquery in select statement example \u003ca href=\"https://leetcode.com/problems/percentage-of-users-attended-a-contest/\"\u003eleetcode\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre class=\"language-sql\"\u003e\u003ccode class=\"language-sql\"\u003e\u003cspan class=\"token keyword\"\u003eselect\u003c/span\u003e contest_id\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token function\"\u003eround\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token function\"\u003ecount\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token operator\"\u003e*\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token operator\"\u003e/\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token keyword\"\u003eselect\u003c/span\u003e \u003cspan class=\"token function\"\u003ecount\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token operator\"\u003e*\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token keyword\"\u003efrom\u003c/span\u003e users\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token operator\"\u003e*\u003c/span\u003e\u003cspan class=\"token number\"\u003e100\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\u003cspan class=\"token number\"\u003e2\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eas\u003c/span\u003e percentage\n\u003cspan class=\"token keyword\"\u003efrom\u003c/span\u003e register\n\u003cspan class=\"token keyword\"\u003egroup\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eby\u003c/span\u003e contest_id\n\u003cspan class=\"token keyword\"\u003eorder\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eby\u003c/span\u003e percentage \u003cspan class=\"token keyword\"\u003edesc\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e contest_id \u003cspan class=\"token keyword\"\u003easc\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cul\u003e\n\u003cli\u003ewhere clauses\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre class=\"language-sql\"\u003e\u003ccode class=\"language-sql\"\u003e\u003cspan class=\"token keyword\"\u003ewhere\u003c/span\u003e field \u003cspan class=\"token operator\"\u003ein\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e'string'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string\"\u003e'string1'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003ewhere\u003c/span\u003e a \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token number\"\u003e6\u003c/span\u003e \u003cspan class=\"token operator\"\u003eor\u003c/span\u003e a \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token number\"\u003e9\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003ewhere\u003c/span\u003e low \u003cspan class=\"token operator\"\u003e\u0026#x3C;\u003c/span\u003e a \u003cspan class=\"token operator\"\u003eand\u003c/span\u003e a \u003cspan class=\"token operator\"\u003e\u0026#x3C;\u003c/span\u003e high\n\u003c/code\u003e\u003c/pre\u003e\n\u003cul\u003e\n\u003cli\u003enot in operator with null values CAREFUL \u003ca href=\"https://stackoverflow.com/questions/129077/null-values-inside-not-in-clause\"\u003estackoverflow\u003c/a\u003e \u003ca href=\"https://leetcode.com/problems/tree-node/submissions/\"\u003eleetcode\u003c/a\u003e\n\u003ca href=\"https://leetcode.com/problems/find-customer-referee/\"\u003e584\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre\u003e\u003ccode\u003eMySQL uses three-valued logic -- TRUE, FALSE and UNKNOWN. Anything compared to NULL evaluates to the third value: UNKNOWN. That “anything” includes NULL itself! That’s why MySQL provides the IS NULL and IS NOT NULL operators to specifically check for NULL.\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre class=\"language-sql\"\u003e\u003ccode class=\"language-sql\"\u003e\u003cspan class=\"token keyword\"\u003eselect\u003c/span\u003e name\n\u003cspan class=\"token keyword\"\u003efrom\u003c/span\u003e customer\n\u003cspan class=\"token keyword\"\u003ewhere\u003c/span\u003e referee_id \u003cspan class=\"token operator\"\u003e!=\u003c/span\u003e \u003cspan class=\"token number\"\u003e2\u003c/span\u003e \u003cspan class=\"token operator\"\u003eor\u003c/span\u003e referee_id \u003cspan class=\"token operator\"\u003eis\u003c/span\u003e \u003cspan class=\"token boolean\"\u003enull\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cul\u003e\n\u003cli\u003efilling in null values - use the IS operator\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre class=\"language-sql\"\u003e\u003ccode class=\"language-sql\"\u003e\u003cspan class=\"token keyword\"\u003ecase\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003ewhen\u003c/span\u003e field \u003cspan class=\"token operator\"\u003eis\u003c/span\u003e \u003cspan class=\"token boolean\"\u003enull\u003c/span\u003e \u003cspan class=\"token keyword\"\u003ethen\u003c/span\u003e \u003cspan class=\"token number\"\u003e0\u003c/span\u003e \u003cspan class=\"token comment\"\u003e# field = 0 would not work\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003eelse\u003c/span\u003e field \u003cspan class=\"token keyword\"\u003eend\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre class=\"language-sql\"\u003e\u003ccode class=\"language-sql\"\u003eIFNULL\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003efield\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token number\"\u003e0\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eAS\u003c/span\u003e field\n\u003c/code\u003e\u003c/pre\u003e\n\u003cul\u003e\n\u003cli\u003edelete\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre class=\"language-sql\"\u003e\u003ccode class=\"language-sql\"\u003e\u003cspan class=\"token keyword\"\u003eDELETE\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eFROM\u003c/span\u003e table_name \u003cspan class=\"token keyword\"\u003eWHERE\u003c/span\u003e condition\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cul\u003e\n\u003cli\u003edelete \u003ca href=\"https://leetcode.com/problems/delete-duplicate-emails/\"\u003eproblem\u003c/a\u003e, cannot delete from referenced table and need to create a temporary copy\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre class=\"language-sql\"\u003e\u003ccode class=\"language-sql\"\u003e\u003cspan class=\"token comment\"\u003e# delete from person\u003c/span\u003e\n\u003cspan class=\"token comment\"\u003e# where id not in (select min(id) from person group by email) \u003c/span\u003e\n\n\u003cspan class=\"token comment\"\u003e# create temporary copy of table\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003edelete\u003c/span\u003e \u003cspan class=\"token keyword\"\u003efrom\u003c/span\u003e person\n\u003cspan class=\"token keyword\"\u003ewhere\u003c/span\u003e id \u003cspan class=\"token operator\"\u003enot\u003c/span\u003e \u003cspan class=\"token operator\"\u003ein\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token keyword\"\u003eselect\u003c/span\u003e t\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eid \u003cspan class=\"token keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token keyword\"\u003eselect\u003c/span\u003e \u003cspan class=\"token function\"\u003emin\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eid\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eas\u003c/span\u003e id \u003cspan class=\"token keyword\"\u003efrom\u003c/span\u003e person \u003cspan class=\"token keyword\"\u003egroup\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eby\u003c/span\u003e email\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e t\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\n\u003c/code\u003e\u003c/pre\u003e\n\u003cul\u003e\n\u003cli\u003esubstring(col_name, start_index, length), length is optional\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre class=\"language-sql\"\u003e\u003ccode class=\"language-sql\"\u003e \u003cspan class=\"token keyword\"\u003eSELECT\u003c/span\u003e SUBSTRING\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e'SQL Tutorial'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token number\"\u003e1\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token number\"\u003e3\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eAS\u003c/span\u003e ExtractString\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\n\u003c/code\u003e\u003c/pre\u003e\n\u003cul\u003e\n\u003cli\u003eunion, union all\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre class=\"language-sql\"\u003e\u003ccode class=\"language-sql\"\u003et1\n\u003cspan class=\"token keyword\"\u003eunion\u003c/span\u003e\nt2 \u003cspan class=\"token comment\"\u003e# duplicates are removed\u003c/span\u003e\n\nt1\n\u003cspan class=\"token keyword\"\u003eunion\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eall\u003c/span\u003e\nt2 \u003cspan class=\"token comment\"\u003e# duplicates are stacked\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cul\u003e\n\u003cli\u003ebetween\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre class=\"language-sql\"\u003e\u003ccode class=\"language-sql\"\u003e\u003cspan class=\"token keyword\"\u003eSELECT\u003c/span\u003e column_name\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003es\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003eFROM\u003c/span\u003e table_name\n\u003cspan class=\"token keyword\"\u003eWHERE\u003c/span\u003e column_name \u003cspan class=\"token operator\"\u003eBETWEEN\u003c/span\u003e value1 \u003cspan class=\"token operator\"\u003eAND\u003c/span\u003e value2\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://leetcode.com/problems/change-null-values-in-a-table-to-the-previous-value/\"\u003e2388\u003c/a\u003e Change Null Values in a Table to the Previous Value\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre class=\"language-sql\"\u003e\u003ccode class=\"language-sql\"\u003e\u003cspan class=\"token keyword\"\u003ewith\u003c/span\u003e cte \u003cspan class=\"token keyword\"\u003eas\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token keyword\"\u003eselect\u003c/span\u003e \u003cspan class=\"token operator\"\u003e*\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e row_number\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eover\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eas\u003c/span\u003e row_num\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eif\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eisnull\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003edrink\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\u003cspan class=\"token number\"\u003e0\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\u003cspan class=\"token number\"\u003e1\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eas\u003c/span\u003e flag \u003cspan class=\"token keyword\"\u003efrom\u003c/span\u003e coffeeshop\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n     cte2 \u003cspan class=\"token keyword\"\u003eas\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token keyword\"\u003eselect\u003c/span\u003e \u003cspan class=\"token operator\"\u003e*\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token function\"\u003esum\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eflag\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eover\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token keyword\"\u003eorder\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eby\u003c/span\u003e row_num\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eas\u003c/span\u003e group_id \u003cspan class=\"token keyword\"\u003efrom\u003c/span\u003e cte\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003eselect\u003c/span\u003e id\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e first_value\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003edrink\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eover\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token keyword\"\u003epartition\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eby\u003c/span\u003e group_id\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eas\u003c/span\u003e drink\n\u003cspan class=\"token keyword\"\u003efrom\u003c/span\u003e cte2\n\u003c/code\u003e\u003c/pre\u003e\n\u003cul\u003e\n\u003cli\u003econcatanete two strings\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre class=\"language-sql\"\u003e\u003ccode class=\"language-sql\"\u003e\u003cspan class=\"token keyword\"\u003eselect\u003c/span\u003e concat\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003es1\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003es2\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eas\u003c/span\u003e combined \n\u003cspan class=\"token keyword\"\u003efrom\u003c/span\u003e t\n\u003c/code\u003e\u003c/pre\u003e\n\u003cul\u003e\n\u003cli\u003elower case, upper case\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre class=\"language-sql\"\u003e\u003ccode class=\"language-sql\"\u003e\u003cspan class=\"token keyword\"\u003eselect\u003c/span\u003e lower\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003es\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e upper\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003es\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003efrom\u003c/span\u003e t\n\u003c/code\u003e\u003c/pre\u003e\n\u003cul\u003e\n\u003cli\u003efunctions in SQL \u003ca href=\"https://leetcode.com/problems/nth-highest-salary/\"\u003eleetcode\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre class=\"language-sql\"\u003e\u003ccode class=\"language-sql\"\u003e\u003cspan class=\"token keyword\"\u003eCREATE\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eFUNCTION\u003c/span\u003e getNthHighestSalary\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eN \u003cspan class=\"token keyword\"\u003eINT\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eRETURNS\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eINT\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003eBEGIN\u003c/span\u003e\n  \u003cspan class=\"token keyword\"\u003eRETURN\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\n      \u003cspan class=\"token comment\"\u003e# Write your MySQL query statement below.\u003c/span\u003e\n\n  \u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003eEND\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e-limit + offset \u003ca href=\"https://leetcode.com/problems/nth-highest-salary/\"\u003eleetcode\u003c/a\u003e\u003c/p\u003e\n\u003cpre class=\"language-sql\"\u003e\u003ccode class=\"language-sql\"\u003e\u003cspan class=\"token keyword\"\u003eSELECT\u003c/span\u003e\n    column_list\n\u003cspan class=\"token keyword\"\u003eFROM\u003c/span\u003e\n    table1\n\u003cspan class=\"token keyword\"\u003eORDER\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eBY\u003c/span\u003e column_list\n\u003cspan class=\"token keyword\"\u003eLIMIT\u003c/span\u003e row_count \u003cspan class=\"token keyword\"\u003eOFFSET\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eoffset\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"token comment\"\u003e# The LIMIT row_count determines the number of rows (row_count) returned by the query.\u003c/span\u003e\n\u003cspan class=\"token comment\"\u003e# The OFFSET offset clause skips the offset rows before beginning to return the rows.\u003c/span\u003e\n\u003cspan class=\"token comment\"\u003e# OFFSET is optional\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cul\u003e\n\u003cli\u003erank in over(partition by)\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre class=\"language-sql\"\u003e\u003ccode class=\"language-sql\"\u003eRANK \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eOVER\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e partition_by_clause \u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e order_by_clause \u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e  \n\nProductID   Name                   LocationID   Quantity Rank  \n\u003cspan class=\"token comment\"\u003e----------- ---------------------- ------------ -------- ----  \u003c/span\u003e\n\u003cspan class=\"token number\"\u003e494\u003c/span\u003e         Paint \u003cspan class=\"token operator\"\u003e-\u003c/span\u003e Silver         \u003cspan class=\"token number\"\u003e3\u003c/span\u003e            \u003cspan class=\"token number\"\u003e49\u003c/span\u003e       \u003cspan class=\"token number\"\u003e1\u003c/span\u003e  \n\u003cspan class=\"token number\"\u003e495\u003c/span\u003e         Paint \u003cspan class=\"token operator\"\u003e-\u003c/span\u003e Blue           \u003cspan class=\"token number\"\u003e3\u003c/span\u003e            \u003cspan class=\"token number\"\u003e49\u003c/span\u003e       \u003cspan class=\"token number\"\u003e1\u003c/span\u003e  \n\u003cspan class=\"token number\"\u003e493\u003c/span\u003e         Paint \u003cspan class=\"token operator\"\u003e-\u003c/span\u003e Red            \u003cspan class=\"token number\"\u003e3\u003c/span\u003e            \u003cspan class=\"token number\"\u003e41\u003c/span\u003e       \u003cspan class=\"token number\"\u003e3\u003c/span\u003e  \n\u003cspan class=\"token number\"\u003e496\u003c/span\u003e         Paint \u003cspan class=\"token operator\"\u003e-\u003c/span\u003e Yellow         \u003cspan class=\"token number\"\u003e3\u003c/span\u003e            \u003cspan class=\"token number\"\u003e30\u003c/span\u003e       \u003cspan class=\"token number\"\u003e4\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cul\u003e\n\u003cli\u003edense rank \u003ca href=\"https://leetcode.com/problems/department-top-three-salaries/\"\u003eleetcode\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre class=\"language-sql\"\u003e\u003ccode class=\"language-sql\"\u003eDENSE_RANK \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eOVER\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e \u003cspan class=\"token operator\"\u003e\u0026#x3C;\u003c/span\u003epartition_by_clause\u003cspan class=\"token operator\"\u003e\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e \u003cspan class=\"token operator\"\u003e\u0026#x3C;\u003c/span\u003e order_by_clause \u003cspan class=\"token operator\"\u003e\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e  \nProductID   Name                               LocationID Quantity Rank  \n\u003cspan class=\"token comment\"\u003e----------- ---------------------------------- ---------- -------- -----  \u003c/span\u003e\n\u003cspan class=\"token number\"\u003e494\u003c/span\u003e         Paint \u003cspan class=\"token operator\"\u003e-\u003c/span\u003e Silver                     \u003cspan class=\"token number\"\u003e3\u003c/span\u003e          \u003cspan class=\"token number\"\u003e49\u003c/span\u003e       \u003cspan class=\"token number\"\u003e1\u003c/span\u003e  \n\u003cspan class=\"token number\"\u003e495\u003c/span\u003e         Paint \u003cspan class=\"token operator\"\u003e-\u003c/span\u003e Blue                       \u003cspan class=\"token number\"\u003e3\u003c/span\u003e          \u003cspan class=\"token number\"\u003e49\u003c/span\u003e       \u003cspan class=\"token number\"\u003e1\u003c/span\u003e  \n\u003cspan class=\"token number\"\u003e493\u003c/span\u003e         Paint \u003cspan class=\"token operator\"\u003e-\u003c/span\u003e Red                        \u003cspan class=\"token number\"\u003e3\u003c/span\u003e          \u003cspan class=\"token number\"\u003e41\u003c/span\u003e       \u003cspan class=\"token number\"\u003e2\u003c/span\u003e  \n\u003cspan class=\"token number\"\u003e496\u003c/span\u003e         Paint \u003cspan class=\"token operator\"\u003e-\u003c/span\u003e Yellow                     \u003cspan class=\"token number\"\u003e3\u003c/span\u003e          \u003cspan class=\"token number\"\u003e30\u003c/span\u003e       \u003cspan class=\"token number\"\u003e3\u003c/span\u003e  \n\u003c/code\u003e\u003c/pre\u003e\n\u003cul\u003e\n\u003cli\u003ecumulative total\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre class=\"language-sql\"\u003e\u003ccode class=\"language-sql\"\u003e\u003cspan class=\"token keyword\"\u003eSELECT\u003c/span\u003e Id\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e StudentName\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e  StudentAge\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\u003cspan class=\"token function\"\u003eSUM\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eStudentAge\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eOVER\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token keyword\"\u003eORDER\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eBY\u003c/span\u003e Id\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eAS\u003c/span\u003e RunningAgeTotal\n\u003cspan class=\"token keyword\"\u003eFROM\u003c/span\u003e Students\n\u003c/code\u003e\u003c/pre\u003e\n\u003cul\u003e\n\u003cli\u003erolling sum/average\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre class=\"language-sql\"\u003e\u003ccode class=\"language-sql\"\u003e\u003cspan class=\"token keyword\"\u003eselect\u003c/span\u003e visited_on\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \n            \u003cspan class=\"token function\"\u003esum\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eamount\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eover\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token keyword\"\u003eorder\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eby\u003c/span\u003e visited_on \u003cspan class=\"token keyword\"\u003erows\u003c/span\u003e \u003cspan class=\"token operator\"\u003ebetween\u003c/span\u003e \u003cspan class=\"token number\"\u003e6\u003c/span\u003e \u003cspan class=\"token keyword\"\u003epreceding\u003c/span\u003e \u003cspan class=\"token operator\"\u003eand\u003c/span\u003e \u003cspan class=\"token keyword\"\u003ecurrent\u003c/span\u003e \u003cspan class=\"token keyword\"\u003erow\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eas\u003c/span\u003e amount\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n            \u003cspan class=\"token function\"\u003eavg\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eamount\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eover\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token keyword\"\u003eorder\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eby\u003c/span\u003e visited_on \u003cspan class=\"token keyword\"\u003erows\u003c/span\u003e \u003cspan class=\"token operator\"\u003ebetween\u003c/span\u003e \u003cspan class=\"token number\"\u003e6\u003c/span\u003e \u003cspan class=\"token keyword\"\u003epreceding\u003c/span\u003e \u003cspan class=\"token operator\"\u003eand\u003c/span\u003e \u003cspan class=\"token keyword\"\u003ecurrent\u003c/span\u003e \u003cspan class=\"token keyword\"\u003erow\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eas\u003c/span\u003e average_amount\n\u003cspan class=\"token keyword\"\u003efrom\u003c/span\u003e customer\n\u003c/code\u003e\u003c/pre\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003ewindow functions\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003esum, avg, first, lead, lag, rank, dense_rank\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003elag window function\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre class=\"language-sql\"\u003e\u003ccode class=\"language-sql\"\u003e\u003cspan class=\"token keyword\"\u003eselect\u003c/span\u003e \u003cspan class=\"token operator\"\u003e*\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e lag\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003epurchase_date\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eover\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token keyword\"\u003epartition\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eby\u003c/span\u003e user_id \u003cspan class=\"token keyword\"\u003eorder\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eby\u003c/span\u003e purchase_date\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eas\u003c/span\u003e previous_date\n\u003cspan class=\"token keyword\"\u003efrom\u003c/span\u003e purchases\n\u003c/code\u003e\u003c/pre\u003e\n\u003cul\u003e\n\u003cli\u003elead, window function for value in the next row\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre class=\"language-sql\"\u003e\u003ccode class=\"language-sql\"\u003e\u003cspan class=\"token keyword\"\u003eSELECT\u003c/span\u003e dept_id\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e last_name\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e salary\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\nLEAD \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003esalary\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\u003cspan class=\"token number\"\u003e1\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eOVER\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token keyword\"\u003eORDER\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eBY\u003c/span\u003e salary\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eAS\u003c/span\u003e next_highest_salary\n\u003cspan class=\"token keyword\"\u003eFROM\u003c/span\u003e employees\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cul\u003e\n\u003cli\u003elike, search in substring, \u003ca href=\"https://leetcode.com/problems/patients-with-a-condition/\"\u003epatients\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre class=\"language-sql\"\u003e\u003ccode class=\"language-sql\"\u003e\u003cspan class=\"token keyword\"\u003eselect\u003c/span\u003e col\n\u003cspan class=\"token keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"token keyword\"\u003etable\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003ewhere\u003c/span\u003e col \u003cspan class=\"token operator\"\u003elike\u003c/span\u003e \u003cspan class=\"token string\"\u003e'%KUR%'\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003eto get island values (group of equal consecutive values in a column) use rank- rank trick, \u003ca href=\"https://leetcode.com/problems/longest-winning-streak/\"\u003eleetcode\u003c/a\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eCAST to datatypes\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre class=\"language-sql\"\u003e\u003ccode class=\"language-sql\"\u003e\u003cspan class=\"token comment\"\u003e-- For Sql server\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003eSELECT\u003c/span\u003e CAST\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token number\"\u003e25.65\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eAS\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eint\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token comment\"\u003e/*\nCAST(\u0026#x3C;value_to_cast\u003e AS \u0026#x3C;data_type_to_cast_to\u003e)\n*/\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cul\u003e\n\u003cli\u003eput stuff in one cell table with group_concat\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre\u003e\u003ccode\u003e+------------+------------+\n| sell_date  | product     |\n+------------+------------+\n| 2020-05-30 | Headphone  |\n| 2020-06-01 | Pencil     |\n| 2020-06-02 | Mask       |\n| 2020-05-30 | Basketball |\n| 2020-06-01 | Bible      |\n+------------+------------+\n\nTO\n\n+------------+----------+------------------------------+\n| sell_date  | num_sold | products                     |\n+------------+----------+------------------------------+\n| 2020-05-30 | 3        | Basketball,Headphone,T-shirt |\n| 2020-06-01 | 2        | Bible,Pencil                 |\n| 2020-06-02 | 1        | Mask                         |\n+------------+----------+------------------------------+\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre class=\"language-sql\"\u003e\u003ccode class=\"language-sql\"\u003e\u003cspan class=\"token comment\"\u003e# Write your MySQL query statement below\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003eselect\u003c/span\u003e sell_date\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token function\"\u003ecount\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token keyword\"\u003edistinct\u003c/span\u003e product\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eas\u003c/span\u003e num_sold\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \ngroup_concat\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token keyword\"\u003edistinct\u003c/span\u003e product \u003cspan class=\"token keyword\"\u003eorder\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eby\u003c/span\u003e product separator \u003cspan class=\"token string\"\u003e','\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eas\u003c/span\u003e products\n\u003cspan class=\"token keyword\"\u003efrom\u003c/span\u003e activities\n\u003cspan class=\"token keyword\"\u003egroup\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eby\u003c/span\u003e sell_date\n\u003c/code\u003e\u003c/pre\u003e\n\u003cul\u003e\n\u003cli\u003epivot trick \u003ca href=\"https://leetcode.com/problems/students-report-by-geography/\"\u003estudent by geography\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre class=\"language-sql\"\u003e\u003ccode class=\"language-sql\"\u003e\u003cspan class=\"token comment\"\u003e# Write your MySQL query statement below\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003eselect\u003c/span\u003e \u003cspan class=\"token function\"\u003emax\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token keyword\"\u003ecase\u003c/span\u003e \u003cspan class=\"token keyword\"\u003ewhen\u003c/span\u003e continent \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token string\"\u003e'America'\u003c/span\u003e \u003cspan class=\"token keyword\"\u003ethen\u003c/span\u003e name \u003cspan class=\"token keyword\"\u003eend\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eas\u003c/span\u003e America\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n       \u003cspan class=\"token function\"\u003emax\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token keyword\"\u003ecase\u003c/span\u003e \u003cspan class=\"token keyword\"\u003ewhen\u003c/span\u003e continent \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token string\"\u003e'Asia'\u003c/span\u003e \u003cspan class=\"token keyword\"\u003ethen\u003c/span\u003e name \u003cspan class=\"token keyword\"\u003eend\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eas\u003c/span\u003e Asia\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n       \u003cspan class=\"token function\"\u003emax\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token keyword\"\u003ecase\u003c/span\u003e \u003cspan class=\"token keyword\"\u003ewhen\u003c/span\u003e continent \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token string\"\u003e'Europe'\u003c/span\u003e \u003cspan class=\"token keyword\"\u003ethen\u003c/span\u003e name \u003cspan class=\"token keyword\"\u003eend\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eas\u003c/span\u003e Europe\n\u003cspan class=\"token keyword\"\u003efrom\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token keyword\"\u003eselect\u003c/span\u003e \u003cspan class=\"token operator\"\u003e*\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e row_number\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eover\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token keyword\"\u003epartition\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eby\u003c/span\u003e continent \u003cspan class=\"token keyword\"\u003eorder\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eby\u003c/span\u003e name\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eas\u003c/span\u003e rn\n\u003cspan class=\"token keyword\"\u003efrom\u003c/span\u003e student\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e t\n\u003cspan class=\"token keyword\"\u003egroup\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eby\u003c/span\u003e rn\n\u003c/code\u003e\u003c/pre\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://leetcode.com/problems/dynamic-pivoting-of-a-table/\"\u003edynamic pivoting\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre class=\"language-sql\"\u003e\u003ccode class=\"language-sql\"\u003e\u003cspan class=\"token comment\"\u003e-- static pivot\u003c/span\u003e\n\u003cspan class=\"token comment\"\u003e-- select product_id,\u003c/span\u003e\n\u003cspan class=\"token comment\"\u003e-- sum(case when store = \"store1\" then price end) as store1,\u003c/span\u003e\n\u003cspan class=\"token comment\"\u003e-- sum(case when store = \"store\"then price end) as store2,\u003c/span\u003e\n\u003cspan class=\"token comment\"\u003e-- ....\u003c/span\u003e\n\u003cspan class=\"token comment\"\u003e-- from products\u003c/span\u003e\n\u003cspan class=\"token comment\"\u003e-- group by product_id\u003c/span\u003e\n\n\n\u003cspan class=\"token comment\"\u003e-- this procedusre would concatenate all select statements in case_stmtsum(..)\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003eCREATE\u003c/span\u003e \u003cspan class=\"token keyword\"\u003ePROCEDURE\u003c/span\u003e PivotProducts\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"token keyword\"\u003eBEGIN\u003c/span\u003e\n\t\u003cspan class=\"token comment\"\u003e# Write your MySQL query statement below.\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003eSET\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eSESSION\u003c/span\u003e group_concat_max_len \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token number\"\u003e1000000\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"token comment\"\u003e--define case statement\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003eselect\u003c/span\u003e group_concat\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token keyword\"\u003edistinct\u003c/span\u003e concat\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e'sum(case when store = \"'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003estore\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\u003cspan class=\"token string\"\u003e'\" then price end) as '\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e store\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003einto\u003c/span\u003e \u003cspan class=\"token variable\"\u003e@case_stmt\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003efrom\u003c/span\u003e products\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"token comment\"\u003e-- get whole sql query\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003eset\u003c/span\u003e \u003cspan class=\"token variable\"\u003e@sql_query\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e concat\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e'select product_id, '\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\u003cspan class=\"token variable\"\u003e@case_stmt\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string\"\u003e' from products group by product_id'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    \n    \u003cspan class=\"token keyword\"\u003eprepare\u003c/span\u003e final_sql_query \u003cspan class=\"token keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"token variable\"\u003e@sql_query\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003eexecute\u003c/span\u003e final_sql_query\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003edeallocate\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eprepare\u003c/span\u003e final_sql_query\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003eEND\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://leetcode.com/problems/dynamic-unpivoting-of-a-table/\"\u003edynamic unpivoting\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://stackoverflow.com/questions/9917196/meaning-of-square-brackets-in-ms-sql-table-designer\"\u003edelimit identifiers\u003c/a\u003e, ignore special symbols, characters, spaces etc\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre class=\"language-sql\"\u003e\u003ccode class=\"language-sql\"\u003e\u003cspan class=\"token keyword\"\u003eselect\u003c/span\u003e \u003cspan class=\"token operator\"\u003e*\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003emy \u003cspan class=\"token keyword\"\u003etable\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003ewhere\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token keyword\"\u003eorder\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token number\"\u003e10\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cul\u003e\n\u003cli\u003eindex column\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre class=\"language-sql\"\u003e\u003ccode class=\"language-sql\"\u003e\u003cspan class=\"token keyword\"\u003eCREATE\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eINDEX\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token keyword\"\u003eindex\u003c/span\u003e name\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eON\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token keyword\"\u003etable\u003c/span\u003e name\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token keyword\"\u003ecolumn\u003c/span\u003e name\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e-transactions\u003c/p\u003e\n\u003cpre class=\"language-sql\"\u003e\u003ccode class=\"language-sql\"\u003e\u003cspan class=\"token keyword\"\u003eBEGIN\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eTRANSACTION\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003eBEGIN\u003c/span\u003e TRY\n\n\u003cspan class=\"token keyword\"\u003eUPDATE\u003c/span\u003e table_name \u003cspan class=\"token keyword\"\u003eSET\u003c/span\u003e BAKIYE \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e BAKIYE \u003cspan class=\"token operator\"\u003e-\u003c/span\u003e \u003cspan class=\"token number\"\u003e1000\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003eWHERE\u003c/span\u003e Name\u003cspan class=\"token operator\"\u003e=\u003c/span\u003e\u003cspan class=\"token string\"\u003e'Name'\u003c/span\u003e \u003cspan class=\"token operator\"\u003eAND\u003c/span\u003e Surname\u003cspan class=\"token operator\"\u003e=\u003c/span\u003e\u003cspan class=\"token string\"\u003e'Surname'\u003c/span\u003e\n\n\u003cspan class=\"token keyword\"\u003eUPDATE\u003c/span\u003e table_name \u003cspan class=\"token keyword\"\u003eSET\u003c/span\u003e BAKIYE \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e BAKIYE \u003cspan class=\"token operator\"\u003e+\u003c/span\u003e \u003cspan class=\"token number\"\u003e1000\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003eWHERE\u003c/span\u003e Name\u003cspan class=\"token operator\"\u003e=\u003c/span\u003e\u003cspan class=\"token string\"\u003e'Name'\u003c/span\u003e \u003cspan class=\"token operator\"\u003eAND\u003c/span\u003e Surname\u003cspan class=\"token operator\"\u003e=\u003c/span\u003e\u003cspan class=\"token string\"\u003e'Surname'\u003c/span\u003e\n\n\u003cspan class=\"token keyword\"\u003eupdate\u003c/span\u003e salary \u003cspan class=\"token keyword\"\u003eset\u003c/span\u003e sex \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eif\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003esex \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e\u003cspan class=\"token string\"\u003e'f'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\u003cspan class=\"token string\"\u003e'm'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\u003cspan class=\"token string\"\u003e'f'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \n\u003cspan class=\"token comment\"\u003e--  swap f to m and m to f in sex column\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003eCOMMIT\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003eEND\u003c/span\u003e TRY\n\u003cspan class=\"token keyword\"\u003eBEGIN\u003c/span\u003e CATCH\n\u003cspan class=\"token keyword\"\u003eROLLBACK\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003eEND\u003c/span\u003e CATCH\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2 id=\"sql-variables\"\u003eSQL Variables\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#sql-variables\"\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003cp\u003eIf we want to use a variable in SQL Server, we have to declare it using \u003ccode\u003eDECLARE\u003c/code\u003e statement.\u003c/p\u003e\n\u003cp\u003eLocal variable names have to start with an at (@) sign.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003edeclaring variables\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre class=\"language-sql\"\u003e\u003ccode class=\"language-sql\"\u003e\u003cspan class=\"token keyword\"\u003eDECLARE\u003c/span\u003e \u003cspan class=\"token variable\"\u003e@TestVariable\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eAS\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eVARCHAR\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token number\"\u003e100\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003eDECLARE\u003c/span\u003e \u003cspan class=\"token variable\"\u003e@TestVariable\u003c/span\u003e \u003cspan class=\"token comment\"\u003e-- NULL initialization\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cul\u003e\n\u003cli\u003eassign values to variables\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre class=\"language-sql\"\u003e\u003ccode class=\"language-sql\"\u003e\u003cspan class=\"token keyword\"\u003eSELECT\u003c/span\u003e \u003cspan class=\"token variable\"\u003e@TestVariable\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token string\"\u003e'Save the Nature'\u003c/span\u003e \u003cspan class=\"token comment\"\u003e--single select line\u003c/span\u003e\n\n\u003cspan class=\"token comment\"\u003e--- ASSIGN LAST VALUE OF TABLE T\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003eselect\u003c/span\u003e \u003cspan class=\"token variable\"\u003e@TestVariable\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e person_name\n\u003cspan class=\"token keyword\"\u003efrom\u003c/span\u003e t\n\u003cspan class=\"token keyword\"\u003ewhere\u003c/span\u003e salary \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token number\"\u003e100000\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cul\u003e\n\u003cli\u003eassign variable value using set\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre class=\"language-sql\"\u003e\u003ccode class=\"language-sql\"\u003e\u003cspan class=\"token keyword\"\u003eDECLARE\u003c/span\u003e \u003cspan class=\"token variable\"\u003e@Variable1\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eAS\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eVARCHAR\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token number\"\u003e100\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003eDECLARE\u003c/span\u003e \u003cspan class=\"token variable\"\u003e@Variable2\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eAS\u003c/span\u003e UNIQUEIDENTIFIER\n\u003cspan class=\"token keyword\"\u003eSET\u003c/span\u003e \u003cspan class=\"token variable\"\u003e@Variable1\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token string\"\u003e'Save Water Save Life'\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003eSET\u003c/span\u003e \u003cspan class=\"token variable\"\u003e@Variable2\u003c/span\u003e\u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token string\"\u003e'6D8446DE-68DA-4169-A2C5-4C0995C00CC1'\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cul\u003e\n\u003cli\u003eassign many varaibles to values\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre class=\"language-sql\"\u003e\u003ccode class=\"language-sql\"\u003e\u003cspan class=\"token keyword\"\u003eDECLARE\u003c/span\u003e \u003cspan class=\"token variable\"\u003e@Variable1\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eAS\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eVARCHAR\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token number\"\u003e100\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token variable\"\u003e@Variable2\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eAS\u003c/span\u003e UNIQUEIDENTIFIER\n\u003cspan class=\"token keyword\"\u003eSELECT\u003c/span\u003e \u003cspan class=\"token variable\"\u003e@Variable1\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token string\"\u003e'Save Water Save Life'\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token variable\"\u003e@Variable2\u003c/span\u003e\u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token string\"\u003e'6D8446DE-68DA-4169-A2C5-4C0995C00CC1'\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cul\u003e\n\u003cli\u003eend of batch, \u003ccode\u003eGO\u003c/code\u003e keyword\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre class=\"language-sql\"\u003e\u003ccode class=\"language-sql\"\u003e\u003cspan class=\"token keyword\"\u003eDECLARE\u003c/span\u003e \u003cspan class=\"token variable\"\u003e@TestVariable\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eAS\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eVARCHAR\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token number\"\u003e100\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003eSET\u003c/span\u003e \u003cspan class=\"token variable\"\u003e@TestVariable\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token string\"\u003e'Think Green'\u003c/span\u003e\nGO\n\u003cspan class=\"token keyword\"\u003ePRINT\u003c/span\u003e \u003cspan class=\"token variable\"\u003e@TestVariable\u003c/span\u003e \u003cspan class=\"token comment\"\u003e-- ERROR, varibale not declared\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cul\u003e\n\u003cli\u003ePREPARE, EXECUTE and DEALLOCATE statement in MySQL\u003c/li\u003e\n\u003cli\u003erunning strings as statements\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre class=\"language-sql\"\u003e\u003ccode class=\"language-sql\"\u003e\u003cspan class=\"token keyword\"\u003eSET\u003c/span\u003e \u003cspan class=\"token variable\"\u003e@s\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token string\"\u003e'SELECT ? + ? AS sumtable'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003ePREPARE\u003c/span\u003e stmt1 \u003cspan class=\"token keyword\"\u003eFROM\u003c/span\u003e \u003cspan class=\"token variable\"\u003e@s\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003eSET\u003c/span\u003e \u003cspan class=\"token variable\"\u003e@a\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token number\"\u003e4\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003eSET\u003c/span\u003e \u003cspan class=\"token variable\"\u003e@b\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token number\"\u003e6\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003eEXECUTE\u003c/span\u003e stmt1 \u003cspan class=\"token keyword\"\u003eUSING\u003c/span\u003e \u003cspan class=\"token variable\"\u003e@a\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token variable\"\u003e@b\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003eDEALLOCATE\u003c/span\u003e \u003cspan class=\"token keyword\"\u003ePREPARE\u003c/span\u003e stmt1\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003ethis would return\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003e+----------+\n| sumtable |\n+----------+\n|       10 |\n+----------+\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2 id=\"sql-cte\"\u003eSQL CTE\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#sql-cte\"\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003cp\u003eCTE = Common Table Expression. These are temporary tables which act as variable that you can use through your code.\n\u003ca href=\"https://leetcode.com/problems/change-null-values-in-a-table-to-the-previous-value/submissions/\"\u003eExample problem\u003c/a\u003e\u003c/p\u003e\n\u003cpre class=\"language-sql\"\u003e\u003ccode class=\"language-sql\"\u003e\u003cspan class=\"token keyword\"\u003ewith\u003c/span\u003e cte \u003cspan class=\"token keyword\"\u003eas\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token keyword\"\u003eselect\u003c/span\u003e \u003cspan class=\"token operator\"\u003e*\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003erank\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eover\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token keyword\"\u003eorder\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eby\u003c/span\u003e money\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eas\u003c/span\u003e r \u003cspan class=\"token keyword\"\u003efrom\u003c/span\u003e t\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n     cte2 \u003cspan class=\"token keyword\"\u003eas\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token keyword\"\u003eselect\u003c/span\u003e \u003cspan class=\"token operator\"\u003e*\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\u003cspan class=\"token function\"\u003emin\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003er\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eas\u003c/span\u003e minn \u003cspan class=\"token keyword\"\u003efrom\u003c/span\u003e cte2\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n     cte3 \u003cspan class=\"token keyword\"\u003eas\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token keyword\"\u003eselect\u003c/span\u003e student \u003cspan class=\"token keyword\"\u003efrom\u003c/span\u003e cte2 \u003cspan class=\"token keyword\"\u003ewhere\u003c/span\u003e r \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e minn\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003eselect\u003c/span\u003e \u003cspan class=\"token operator\"\u003e*\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003efrom\u003c/span\u003e cte3\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eAvoid running lots of subqueries, joining, carrying tables around!\u003c/p\u003e\n\u003ch2 id=\"sql-recursion\"\u003eSQL recursion\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#sql-recursion\"\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003cp\u003eBasic SQL cannot express unbounded computations.\u003c/p\u003e\n\u003cp\u003eTable: ParentOf\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003eParent |  Child\nSue    |  Mary\nBob    |  Mary\nFred   |  Bob\nJane   |  Bob\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eTasks: Find Parent, Grandparent (two instances of ParentOf), Grand-grand parent(three instances of ParentOf)\nNote you need recursion\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003eWith\u003c/code\u003e construct exists in SQL by itself. It often used to have recursion in SQL.\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/dendron-wiki/assets/images/with_statement.png\" alt=\"with_statement.png\" style=\"width:600px;\"\u003e\u003c/p\u003e\n\u003cp\u003eeach relation R is the result of its corresponding query. Final result of the master LAST query. Can thing of \u003ccode\u003eAS\u003c/code\u003e to be an\nassignment for the realtions\u003c/p\u003e\n\u003cp\u003eWe can specify recursive statements using the \u003ccode\u003eRecursive\u003c/code\u003e keyword after \u003ccode\u003eWith\u003c/code\u003e\u003c/p\u003e\n\u003cpre class=\"language-sql\"\u003e\u003ccode class=\"language-sql\"\u003e\u003cspan class=\"token keyword\"\u003eWITH\u003c/span\u003e RECURSIVE cte_name \u003cspan class=\"token keyword\"\u003eAS\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\n    initial_query  \u003cspan class=\"token comment\"\u003e-- anchor member\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003eUNION\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eALL\u003c/span\u003e\n    recursive_query \u003cspan class=\"token comment\"\u003e-- recursive member that references to the CTE name\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003eSELECT\u003c/span\u003e \u003cspan class=\"token operator\"\u003e*\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eFROM\u003c/span\u003e cte_name\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre class=\"language-sql\"\u003e\u003ccode class=\"language-sql\"\u003e\u003cspan class=\"token keyword\"\u003eWITH\u003c/span\u003e RECURSIVE cte_count\n\u003cspan class=\"token keyword\"\u003eAS\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\n      \u003cspan class=\"token keyword\"\u003eSELECT\u003c/span\u003e \u003cspan class=\"token number\"\u003e1\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eas\u003c/span\u003e n\u003cspan class=\"token comment\"\u003e-- BASE CASE\u003c/span\u003e\n      \u003cspan class=\"token keyword\"\u003eUNION\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eALL\u003c/span\u003e \u003cspan class=\"token comment\"\u003e# might enter infinite loop, careful\u003c/span\u003e\n      \u003cspan class=\"token keyword\"\u003eSELECT\u003c/span\u003e n \u003cspan class=\"token operator\"\u003e+\u003c/span\u003e \u003cspan class=\"token number\"\u003e1\u003c/span\u003e\n      \u003cspan class=\"token keyword\"\u003eFROM\u003c/span\u003e cte_count \u003cspan class=\"token comment\"\u003e-- Recursive call, should dependt on the relation itself CTE_COUNT!\u003c/span\u003e\n      \u003cspan class=\"token keyword\"\u003eWHERE\u003c/span\u003e n \u003cspan class=\"token operator\"\u003e\u0026#x3C;\u003c/span\u003e \u003cspan class=\"token number\"\u003e3\u003c/span\u003e\n    \u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003eSELECT\u003c/span\u003e n\n\u003cspan class=\"token keyword\"\u003eFROM\u003c/span\u003e cte_count\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003cimg src=\"/dendron-wiki/assets/images/recursion_example.png\" alt=\"recursion_example.png\" style=\"width:600px;\"\u003e\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003egenerate consecutive numbers\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre class=\"language-sql\"\u003e\u003ccode class=\"language-sql\"\u003e\u003cspan class=\"token keyword\"\u003eWITH\u003c/span\u003e RECURSIVE seq \u003cspan class=\"token keyword\"\u003eAS\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003eSELECT\u003c/span\u003e \u003cspan class=\"token number\"\u003e0\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eAS\u003c/span\u003e \u003cspan class=\"token keyword\"\u003evalue\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eUNION\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eALL\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eSELECT\u003c/span\u003e \u003cspan class=\"token keyword\"\u003evalue\u003c/span\u003e \u003cspan class=\"token operator\"\u003e+\u003c/span\u003e \u003cspan class=\"token number\"\u003e1\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eFROM\u003c/span\u003e seq \u003cspan class=\"token keyword\"\u003eWHERE\u003c/span\u003e \u003cspan class=\"token keyword\"\u003evalue\u003c/span\u003e \u003cspan class=\"token operator\"\u003e\u0026#x3C;\u003c/span\u003e \u003cspan class=\"token number\"\u003e100\u003c/span\u003e\n    \u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"token keyword\"\u003eSELECT\u003c/span\u003e \u003cspan class=\"token operator\"\u003e*\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eFROM\u003c/span\u003e seq\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cul\u003e\n\u003cli\u003ewith statement \u003ca href=\"https://leetcode.com/problems/the-number-of-seniors-and-juniors-to-join-the-company/\"\u003eleetcode\u003c/a\u003e\nBasic SQL cannot express unbounded computations. WITH construct is available in SQL without recursion. But this is the construct used to ADD recursion in SQL. CTE = common table expression. WITH is like a function in SQL\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre class=\"language-sql\"\u003e\u003ccode class=\"language-sql\"\u003e\u003cspan class=\"token keyword\"\u003ewith\u003c/span\u003e R1 \u003cspan class=\"token keyword\"\u003eas\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003equery \u003cspan class=\"token number\"\u003e1\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n     R2 \u003cspan class=\"token keyword\"\u003eas\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003equery \u003cspan class=\"token number\"\u003e2\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n     \u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\n     CTE \u003cspan class=\"token keyword\"\u003eas\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003equery\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n     \n \u003cspan class=\"token operator\"\u003e\u0026#x3C;\u003c/span\u003equery involving \u003cspan class=\"token keyword\"\u003eall\u003c/span\u003e R1\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e R2 \u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eRn\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e CTE \u003cspan class=\"token operator\"\u003e+\u003c/span\u003e other \u003cspan class=\"token keyword\"\u003etables\u003c/span\u003e\u003cspan class=\"token operator\"\u003e\u003e\u003c/span\u003e \u003cspan class=\"token comment\"\u003e# return this last query\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cul\u003e\n\u003cli\u003erecursion\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre class=\"language-sql\"\u003e\u003ccode class=\"language-sql\"\u003e\u003cspan class=\"token keyword\"\u003eWITH\u003c/span\u003e RECURSIVE cte_name \u003cspan class=\"token keyword\"\u003eAS\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\n    cte_query_definition \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ethe anchor member\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\n    \u003cspan class=\"token keyword\"\u003eUNION\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eALL\u003c/span\u003e\n\n    cte_query_definition \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ethe recursive member\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token comment\"\u003e# often need where statement to stop\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\n \n\u003cspan class=\"token keyword\"\u003eSELECT\u003c/span\u003e \u003cspan class=\"token operator\"\u003e*\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003eFROM\u003c/span\u003e   cte_name\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003cimg src=\"/dendron-wiki/assets/images/recursion_query.png\" alt=\"recursion_query.png\"\u003e\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/dendron-wiki/assets/images/recursion.png\" alt=\"recursion.png\"\u003e\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eclassic family tree recursion \u003ca href=\"https://leetcode.com/problems/all-people-report-to-the-given-manager/\"\u003eproblem\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"sql-indexing\"\u003eSQL indexing\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#sql-indexing\"\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003cp\u003e\u003ca href=\"https://www.youtube.com/watch?v=Y7Qlc7f_u0o\"\u003eStanford Lecture\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003eIndex column B and you can ask questions such as show me the rows where elements in column B belong to certain interval\nis going to be faster.\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/dendron-wiki/assets/images/indexing.png\" alt=\"indexing.png\" style=\"width:600px;\"\u003e\u003c/p\u003e\n\u003cp\u003eUsers don't access indexes! They are used underneath by the query execution engine.\u003c/p\u003e\n\u003cp\u003eUnderlying data structures = type of indexes:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003ehash allows only concrete checks such as table.A = val \u003cstrong\u003eO(1)\u003c/strong\u003e\u003c/li\u003e\n\u003cli\u003eB+ trees allows checks such as table.A = val, v1 \u0026#x3C; table.A \u0026#x3C;= v2 \u003cstrong\u003eO(log(n))\u003c/strong\u003e\u003c/li\u003e\n\u003cli\u003eR+ trees\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eNo indexes is \u003cstrong\u003eO(n)\u003c/strong\u003e time\nMany DBMS's build indexes automatically on \u003ccode\u003ePRIMARY KEY\u003c/code\u003e (and sometimes \u003ccode\u003eUNIQUE\u003c/code\u003e) attributes.\u003c/p\u003e\n\u003cp\u003eExamples:\u003c/p\u003e\n\u003cpre class=\"language-sql\"\u003e\u003ccode class=\"language-sql\"\u003e\u003cspan class=\"token keyword\"\u003eselect\u003c/span\u003e student_id\n\u003cspan class=\"token keyword\"\u003efrom\u003c/span\u003e student\n\u003cspan class=\"token keyword\"\u003ewhere\u003c/span\u003e student_name \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token string\"\u003e'Kuny'\u003c/span\u003e \u003cspan class=\"token operator\"\u003eand\u003c/span\u003e gpa \u003cspan class=\"token operator\"\u003e\u003e\u003c/span\u003e \u003cspan class=\"token number\"\u003e3.9\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cul\u003e\n\u003cli\u003eindex on student_name (hash-based index)\u003c/li\u003e\n\u003cli\u003eindex on gpa (tree-based)\u003c/li\u003e\n\u003cli\u003eindex on (student_name,gpa)\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre class=\"language-sql\"\u003e\u003ccode class=\"language-sql\"\u003e\u003cspan class=\"token keyword\"\u003eselect\u003c/span\u003e s_name\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e c_name\n\u003cspan class=\"token keyword\"\u003efrom\u003c/span\u003e student\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eapply\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003ewhere\u003c/span\u003e student\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003es_id \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eapply\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003es_id\n\u003c/code\u003e\u003c/pre\u003e\n\u003cul\u003e\n\u003cli\u003eno indexing is \u003ccode\u003eO(m*n)\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003eindex student.s_id -\u003e \u003ccode\u003eO(n)\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003eindex apply.s_id -\u003e \u003ccode\u003eO(m)\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eDownsides of indexes:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eextra space (persistent data structure stored underneath the database) = marginal downside (ok-ish)\u003c/li\u003e\n\u003cli\u003eindex created = medium downside/initialization can be slow\u003c/li\u003e\n\u003cli\u003eindex maintenance, can offset benefits. If we modify often the const of maintaining the indexes (re-initialization)\ncan be quite expensive. If you do lots of writes and less reads better not use indexes.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre class=\"language-sql\"\u003e\u003ccode class=\"language-sql\"\u003e\u003cspan class=\"token keyword\"\u003ecreate\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eindex\u003c/span\u003e your_index_name \u003cspan class=\"token keyword\"\u003eon\u003c/span\u003e your_table_name\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eyour_column_name\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eusing\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eHASH\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token operator\"\u003eor\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003ecreate\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eindex\u003c/span\u003e your_index_name \u003cspan class=\"token keyword\"\u003eon\u003c/span\u003e your_table_name\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eyour_column_name\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eusing\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eBTREE\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eThe best way to improve the performance of SELECT operations is to create indexes on one or more of the columns that are tested in the query. The index entries act like pointers to the table rows, allowing the query to quickly determine which rows match a condition in the WHERE clause, and retrieve the other column values for those rows. All MySQL data types can be indexed.\nIndexes are used to find rows with specific column values quickly. Without an index, MySQL must begin with the first row\nand then read through the entire table to find the relevant rows.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eindex columns used in \u003ccode\u003eWHERE\u003c/code\u003e clauses\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003cstrong\u003eColumn Indexes\u003c/strong\u003e\nThe most common type of index involves a single column, storing copies of the values from that column in a data structure, allowing fast lookups for the rows with the corresponding column values. The B-tree data structure lets the index quickly find a specific value, a set of values, or a range of values, corresponding to operators such as\u003ccode\u003e =, \u003e, ≤, BETWEEN, IN,\u003c/code\u003e and so on, in a \u003ccode\u003eWHERE\u003c/code\u003e clause.\u003c/p\u003e\n\u003ch2 id=\"database-design\"\u003eDatabase design\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#database-design\"\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003col\u003e\n\u003cli\u003e\n\u003cp\u003eUnderstand the Data – Is it relational or document-based? Do you need to manage complex queries or just store simple key-value pairs?\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eScalability Is Key – High traffic? Complex joins?\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eConsistency vs. Performance – Do you need strong consistency (ACID) or can you tolerate eventual consistency for better availability and partition tolerance? \u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eAccount for Future Evolution  – Can your database scale? Is it flexible enough for new features?\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eKeep It Simple\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003e\u003ca href=\"https://www.youtube.com/watch?v=DFnAakJ4FDg\u0026#x26;list=PL9ysvtVnryGpnIj9rcIqNDxakUn6v72Hm\u0026#x26;index=31\"\u003eDesign by decomposition\u003c/a\u003e\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003estart with 'mega' relations containing everything\u003c/li\u003e\n\u003cli\u003edecompose into smaller, better relations with same info\u003c/li\u003e\n\u003cli\u003ecan do decomosition automatically\n\u003cstrong\u003eFinal set of relations satisfies normal form\u003c/strong\u003e (normalization of a database) = no redundant data, updates are easier to be made.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eDenormalised database example:\u003c/p\u003e\n\u003cpre class=\"language-sql\"\u003e\u003ccode class=\"language-sql\"\u003e\u003cspan class=\"token keyword\"\u003eApply\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eSSN\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e student_name\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e college_name\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e high_school\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e city\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e hobby\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003cem\u003eApply\u003c/em\u003e is a table with all columns (ssn = social security number) stored in one place.\nTo record Ann with SSN = 123 from Sofia, studied at SMG and 125, plays tennis and trumpet and applied at Stanford, Berkeley, MIT\nwe need 12 different rows! Studied at SMG will be repeated 6 times, applied at MIT will be repeated 4 times.\n\u003cstrong\u003eRedundancy\u003c/strong\u003e in the database.\u003c/p\u003e\n\u003cp\u003eNormalised database:\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003eStudent(SSN, student_name)\nApply(SSN, college_name)\nHighSchool(SSN, high_school)\nLocated(high_school, city)\nHobbies(SSN, hobby)\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eDecide how to normalize your database by looking for:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003efunctional dependencies\u003c/li\u003e\n\u003cli\u003emultivalued dependencies\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003cem\u003eBuzz word\u003c/em\u003e If you see Functional Dependency  use Boyce-Codd Normal Form (decompose your table)\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/dendron-wiki/assets/images/functional_dep.png\" alt=\"functional_dep.png\" style=\"width:600px;\"\u003e\u003c/p\u003e\n\u003cp\u003e\u003cem\u003eBuzz word\u003c/em\u003e If you see multivalued Dependency  use Boyce-Codd Normal Form (decompose your table)\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/dendron-wiki/assets/images/multivalued_dep.png\" alt=\"multivalued_dep.png\" style=\"width:600px;\"\u003e\u003c/p\u003e\n\u003cp\u003eMaybe check this \u003ca href=\"https://www.youtube.com/watch?v=GFQaEYEc8_8\u0026#x26;ab_channel=Decomplexify\"\u003eyoutube\u003c/a\u003e\u003c/p\u003e\n\u003ch2 id=\"orm\"\u003eORM\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#orm\"\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003cp\u003eSQL Alchemy\u003c/p\u003e\n\u003cp\u003eORM\u003c/p\u003e\n\u003cp\u003eRelational Map, e.g. from SQL to Python\u003c/p\u003e\n\u003cp\u003eleaky/soft abstraction\u003c/p\u003e\n\u003ch1 id=\"problems\"\u003eProblems\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#problems\"\u003e\u003c/a\u003e\u003c/h1\u003e\n\u003cp\u003e\u003ca href=\"https://leetcode.com/problems/find-the-start-and-end-number-of-continuous-ranges/\"\u003e1285\u003c/a\u003e\n\u003ca href=\"https://leetcode.com/problems/nth-highest-salary/\"\u003e177\u003c/a\u003e\n\u003ca href=\"https://leetcode.com/problems/find-median-given-frequency-of-numbers/submissions/\"\u003e571\u003c/a\u003e\n\u003ca href=\"https://leetcode.com/problems/biggest-window-between-visits/\"\u003e1709\u003c/a\u003e\n\u003ca href=\"https://leetcode.com/problems/all-people-report-to-the-given-manager/\"\u003e1270\u003c/a\u003e\n\u003ca href=\"https://leetcode.com/problems/find-the-missing-ids/\"\u003e1613\u003c/a\u003e\n\u003ca href=\"https://leetcode.com/problems/median-employee-salary/\"\u003e569\u003c/a\u003e\n\u003ca href=\"https://leetcode.com/problems/tree-node/submissions/\"\u003e608\u003c/a\u003e\n\u003ca href=\"https://leetcode.com/problems/arrange-table-by-gender/\"\u003e2308\u003c/a\u003e\n\u003ca href=\"https://leetcode.com/problems/users-with-two-purchases-within-seven-days/\"\u003e2228\u003c/a\u003e\n\u003ca href=\"https://leetcode.com/problems/find-the-start-and-end-number-of-continuous-ranges/submissions/\"\u003e1285\u003c/a\u003e\n\u003ca href=\"https://leetcode.com/problems/get-the-second-most-recent-activity/\"\u003e1369\u003c/a\u003e\u003c/p\u003e\n\u003ch1 id=\"topics\"\u003eTopics\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#topics\"\u003e\u003c/a\u003e\u003c/h1\u003e\n\u003cp\u003eSpace and Time Complexity intro to Queries: \u003ca href=\"https://medium.com/learning-data/understanding-algorithmic-time-efficiency-in-sql-queries-616176a85d02\"\u003ehttps://medium.com/learning-data/understanding-algorithmic-time-efficiency-in-sql-queries-616176a85d02\u003c/a\u003e\u003cbr\u003e\nBasic (important!) Query Optimisation Techniques: \u003ca href=\"https://medium.com/learning-sql/12-tips-for-optimizing-sql-queries-for-faster-performance-8c6c092d7af1\"\u003ehttps://medium.com/learning-sql/12-tips-for-optimizing-sql-queries-for-faster-performance-8c6c092d7af1\u003c/a\u003e\u003cbr\u003e\nAdvanced Topics in SQL: \u003ca href=\"https://sqlpad.io/tutorial/advanced-sql/\"\u003ehttps://sqlpad.io/tutorial/advanced-sql/\u003c/a\u003e  \u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eUNION, GROU[ BY (UNDERSTAND HOW IT WORKS), INDEXATION, PARTITION\u003cbr\u003e\nB-TREE: \u003ca href=\"https://builtin.com/data-science/b-tree-index\"\u003ehttps://builtin.com/data-science/b-tree-index\u003c/a\u003e (fundamental Database data structure! - connection to indexing!)  \u003c/li\u003e\n\u003c/ul\u003e","noteIndex":{"id":"wn8PE1RhG0znK1alrGFYv","title":"Root","desc":"","updated":1744237493819,"created":1631901573363,"custom":{"nav_order":0,"permalink":"/"},"fname":"root","type":"note","vault":{"fsPath":"vault"},"contentHash":"ea936af1aea818f3052610daac103a63","links":[],"anchors":{},"children":["dgcsvcwea8scgdegrk9tfni","xig93vo47ou1bkr7s4w1wb2","ro9bbyftsutm88mxw6r16p5","ypia1zmywsklpicmcgrzlz1","w7iitlako61ppm27mym400a","6bx5plramu4hksomqc1n55z","4nki3bedlvs3mnkixj3a07k","9r5ym61dkwap92fvbte1jkq","849u97nrsuyekmr4a1r92ux","2b5bwf46z6v132wu7xghvrp","dygp5h2vzw4mkromwmofynb","7h50s7ga5ziiyblmoctsqmw","pglaolxcge4xfvgoph3je89","uy9u1co5ih1fokind8tg0eq","jc23ggp8iiu92kpnzo721to","f1u2a47guuw70olv36bzf66","c1bs7wsjfbhb0zipaywqv1","2av385tcj2cbumxprsauff3","v77wdzobzcackzimz6a7crv"],"parent":null,"data":{},"body":"\nWelcome to my Knowledge Base! Here I write about my perception of life, document exciting things I've learned, debate (with myself) on controversial topics. If you know me you will not be surprised to find out that I write mostly about engineering and maths. Other topics I'm interested in are economics, politics, business, chess and poker."},"collectionChildren":null,"customHeadContent":null,"config":{"version":5,"dev":{"enablePreviewV2":true},"commands":{"lookup":{"note":{"selectionMode":"extract","confirmVaultOnCreate":false,"leaveTrace":false,"bubbleUpCreateNew":true,"fuzzThreshold":0.2,"vaultSelectionModeOnCreate":"smart"}},"insertNote":{"initialValue":"templates"},"insertNoteLink":{"aliasMode":"none","enableMultiSelect":false},"insertNoteIndex":{"enableMarker":false},"randomNote":{},"copyNoteLink":{"aliasMode":"title"},"templateHierarchy":"template"},"workspace":{"vaults":[{"fsPath":"vault"}],"journal":{"dailyDomain":"daily","name":"journal","dateFormat":"y.MM.dd","addBehavior":"childOfDomain"},"scratch":{"name":"scratch","dateFormat":"y.MM.dd.HHmmss","addBehavior":"asOwnDomain"},"graph":{"zoomSpeed":1,"createStub":false},"enableAutoCreateOnDefinition":false,"enableXVaultWikiLink":false,"enableRemoteVaultInit":true,"workspaceVaultSyncMode":"noCommit","enableAutoFoldFrontmatter":true,"maxPreviewsCached":10,"maxNoteLength":204800,"task":{"name":"","dateFormat":"","addBehavior":"childOfCurrent","statusSymbols":{"":" ","wip":"w","done":"x","assigned":"a","moved":"m","blocked":"b","delegated":"l","dropped":"d","pending":"y"},"prioritySymbols":{"H":"high","M":"medium","L":"low"},"todoIntegration":false,"createTaskSelectionType":"selection2link","taskCompleteStatus":["done","x"]},"enableUserTags":true,"enableHashTags":true,"dendronVersion":"0.95.0","enableEditorDecorations":true,"enableFullHierarchyNoteTitle":false,"templateHierarchy":"template"},"preview":{"enableFMTitle":true,"enableNoteTitleForLink":true,"enablePrettyRefs":true,"enableKatex":true,"automaticallyShowPreview":false,"enableFrontmatterTags":true,"enableHashesForFMTags":false},"publishing":{"enableFMTitle":true,"enableNoteTitleForLink":true,"enablePrettyRefs":true,"enableKatex":true,"copyAssets":true,"siteHierarchies":["root"],"writeStubs":false,"siteRootDir":"docs","seo":{"title":"Dendron","description":"Personal knowledge space"},"github":{"enableEditLink":true,"editLinkText":"Edit this page on GitHub","editBranch":"main","editViewMode":"tree"},"enableSiteLastModified":true,"enableFrontmatterTags":true,"enableHashesForFMTags":false,"enableRandomlyColoredTags":true,"enableTaskNotes":true,"enablePrettyLinks":true,"searchMode":"lookup","assetsPrefix":"/dendron-wiki","siteUrl":"https://ngocuong0105.github.io","duplicateNoteBehavior":{"action":"useVault","payload":["vault"]},"theme":"light","templateVersion":"0.97.0","ga":{"tracking":"G-W5DRRLQ1N7"},"siteFaviconPath":"favicon.ico","siteIndex":"root"}}},"__N_SSG":true},"page":"/notes/[id]","query":{"id":"sbumi7y73tummx1u7z1vo6s"},"buildId":"hUMuUtBSCkU7YSeQn-rle","assetPrefix":"/dendron-wiki","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>