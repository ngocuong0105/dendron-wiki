{"pageProps":{"note":{"id":"vl59xstqw0sfbuhf9vthk7n","title":"Data Storage","desc":"","updated":1762334984734,"created":1761560874708,"custom":{},"fname":"engineering.Concepts.Data Storage","type":"note","vault":{"fsPath":"vault"},"contentHash":"6d27990e4ffcf21dbc63189f9103faf2","links":[],"anchors":{"data-storage-technologies":{"type":"header","text":"Data Storage Technologies","value":"data-storage-technologies","line":9,"column":0,"depth":1},"s3":{"type":"header","text":"S3","value":"s3","line":14,"column":0,"depth":2},"datalake":{"type":"header","text":"Datalake","value":"datalake","line":25,"column":0,"depth":2},"redshift":{"type":"header","text":"Redshift","value":"redshift","line":28,"column":0,"depth":2},"mysql":{"type":"header","text":"MySQL","value":"mysql","line":40,"column":0,"depth":2},"casandra":{"type":"header","text":"Casandra","value":"casandra","line":48,"column":0,"depth":2},"elasticsearch":{"type":"header","text":"ElasticSearch","value":"elasticsearch","line":50,"column":0,"depth":2},"hdf5":{"type":"header","text":"HDF5","value":"hdf5","line":52,"column":0,"depth":2},"data-catalog":{"type":"header","text":"Data Catalog","value":"data-catalog","line":59,"column":0,"depth":1},"aws-glue":{"type":"header","text":"AWS Glue","value":"aws-glue","line":65,"column":0,"depth":2},"apache-iceberg":{"type":"header","text":"Apache Iceberg","value":"apache-iceberg","line":72,"column":0,"depth":2},"yelp-dlv1-to-dlv2":{"type":"header","text":"Yelp DLv1 to DLv2","value":"yelp-dlv1-to-dlv2","line":87,"column":0,"depth":3},"acid-transactions":{"type":"header","text":"ACID transactions","value":"acid-transactions","line":102,"column":0,"depth":4},"hdf5-1":{"type":"header","text":"HDF5","value":"hdf5-1","line":115,"column":0,"depth":1}},"children":[],"parent":"7khpigcji0ufpuptuqozcft","data":{}},"body":"<h1 id=\"data-storage\">Data Storage<a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#data-storage\"></a></h1>\n<p>When you build a data infrastructure system you will consider tradeoffs between cost, efficiency, pattern accessability (online va offline, key:value pair vs relational), volume.</p>\n<h1 id=\"data-storage-technologies\">Data Storage Technologies<a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#data-storage-technologies\"></a></h1>\n<p>AWS has S3 (e.g DataLake), Redshift, MySQL, Cassandra, ElasticSearch.</p>\n<h2 id=\"s3\">S3<a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#s3\"></a></h2>\n<p>AWS service. Cloud storage. Structured (csv, parquet, csv) and Unstructured (images,videos, documents, parquets) data</p>\n<ul>\n<li>Offline availability</li>\n<li>Best for logs, historical data, backup - the defacto option for archives</li>\n<li>Benefits: extremely low $ cost, essentially infinite storage capacity, scales horizontally</li>\n<li>Disadvantages: no built-in query. Need to load it in some other data store to work with the data</li>\n<li>S3 is basically a filesystem (buckets instead of folders)</li>\n</ul>\n<p>Can query using additional services like Athena, or you load in spark.</p>\n<h2 id=\"datalake\">Datalake<a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#datalake\"></a></h2>\n<p>AWS service. Claud storage. Built on top of S3. Structured and Unstructured data. Allows to query data using ATHENA (SQL quering engine for S3)</p>\n<h2 id=\"redshift\">Redshift<a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#redshift\"></a></h2>\n<p>AWS service. Columnar data storage, fully manged data warehouse service. Relational db design. Structured data only (tables schemas)</p>\n<p>Stores data in clusters.</p>\n<ul>\n<li>Offline availability</li>\n<li>Best for analytics, data exploration and analysis</li>\n<li>Benefits: good options for doing expensive joins. SQL based quering.</li>\n<li>Disadvantages: high cost</li>\n</ul>\n<h2 id=\"mysql\">MySQL<a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#mysql\"></a></h2>\n<p>Relational database. Used for structured data and transactions, such as user profiles and reviews. Transaction is a row/tuple in sQL table.</p>\n<ul>\n<li>Offline and Online (e.g when Yelp user searches something/ send a message it is directly stored and accessed) availability </li>\n<li>ACID compliance provides strongest form of data reliability</li>\n</ul>\n<h2 id=\"casandra\">Casandra<a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#casandra\"></a></h2>\n<h2 id=\"elasticsearch\">ElasticSearch<a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#elasticsearch\"></a></h2>\n<h2 id=\"hdf5\">HDF5<a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#hdf5\"></a></h2>\n<p>Susquehanna uses this.</p>\n<ul>\n<li></li>\n</ul>\n<h1 id=\"data-catalog\">Data Catalog<a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#data-catalog\"></a></h1>\n<p>This is a catalog service =  metadata layer that describes data not the data itself.</p>\n<p>Data catalog technologies offer another layer of abstraction on top of data storage technologies. They help you discover, manage and govern your data assets. </p>\n<h2 id=\"aws-glue\">AWS Glue<a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#aws-glue\"></a></h2>\n<p>AWS Glue is a centralized metadata catalog that allows:</p>\n<ul>\n<li>schema management, track schema versions, schema evolution, register schemas.</li>\n<li>metadata management - catalog of what data exists and where</li>\n<li>data discovery layer - search and discover datasets, and querable by downstream engines.</li>\n</ul>\n<h2 id=\"apache-iceberg\">Apache Iceberg<a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#apache-iceberg\"></a></h2>\n<p>Apache is a open source foundation project. Iceberg is a table format for huge analytic datasets. It is designed to improve on the limitations of other table formats like Hive.</p>\n<p>Iceberg is supported in AWS. You can create Iceberg tables. For example in CAPI you had to migrate from normal tables in DataLave v1 to DataLake v2 (these are Yelp related datalakes). DLv2 uses Iceberg table format. It allows you to have:</p>\n<ul>\n<li>ACID transactions (marketing)</li>\n<li>Time travel and rollback via its integrated snapshots tooling.</li>\n<li>Multi-partioned tables (dt=2024-01-01/client_id=sephora). More control over partitioning strategies. When you run a backfill you could select which data to change based on partition filters.</li>\n<li>No need for physical deletes (use DELETE statements that mark data as deleted without physically removing it right away)</li>\n<li>tracks schema evolution</li>\n</ul>\n<p>Multipartitioning: </p>\n<ul>\n<li>isolation whenever you insert/update/delete data. Before updating data for one client meant you need to rerun for all.</li>\n<li></li>\n</ul>\n<h3 id=\"yelp-dlv1-to-dlv2\">Yelp DLv1 to DLv2<a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#yelp-dlv1-to-dlv2\"></a></h3>\n<p>Since 2017 Yelp's data lake has used the Hive table format. Since then, Apache Iceberg has gained significant adoption in the industry -- proving to be Hive's successor -- and brings many enhancements.</p>\n<p>Like Hive, Iceberg stores Parquet files in S3 and metadata in AWS Glue. Iceberg tables exist in the AWS Glue catalog and work with Spark, Athena, and Redshift just as Hive tables do, but with extra features.</p>\n<p><a href=\"https://iceberg.apache.org/spec/#version-1-analytic-data-tables\">ICEBERG Tech Spec</a></p>\n<p>One of Iceberg's design goals is to present a data lake table that works as a SQL table does without any surprises, so is not required to know these concepts, however some Iceberg users may be curious to understand them.</p>\n<p>Iceberg metadata is stored in a tree structure. The image below may look complicated at first glance, but users of Iceberg do not need to understand it in order to use an Iceberg table.</p>\n<h4 id=\"acid-transactions\">ACID transactions<a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#acid-transactions\"></a></h4>\n<p>Hive tables have many areas of undefined behavior which introduce data inconsistencies and data quality issues, especially when multiple processes are reading and writing to a table. Iceberg's provides ACID transactions and guarantees about behaviors for reads and writes.</p>\n<p>Iceberg's tables store the S3 path of the current metadata on the Glue table as a table property. This is the basis for the below behaviors.</p>\n<ul>\n<li>\n<p>Atomic Operations: Data files are added or removed in a single, complete operation, ensuring that writes are never partially visible. Iceberg writes data to S3 and commits changes by updating a metadata reference in the Glue table, which supports atomic updates.</p>\n</li>\n<li>\n<p>Consistency &#x26; Isolation: Iceberg provides optimistic concurrency and serializable isolation. Readers only access commited data and will see a consistent and correct view of data even while a writer concurrently commits to the table. Serializable isolation ensures that multiple writers will not introduce inconsistent states by ensuring that only one process writes to a table at a time. In some cases serializable isolation can impede workflows, see Iceberg Known Issues and Limitations for alternatives (parallel backfills can be tricky).</p>\n</li>\n</ul>\n<p>-Durable: Once a transaction is committed, it will not be lost. Durability is provided by S3 similarly to Hive tables. </p>\n<h1 id=\"hdf5-1\">HDF5<a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#hdf5-1\"></a></h1>\n<p>SIG uses this data format (<code>.hdf5</code>). Another technology to manage data.</p>\n<ul>\n<li>HDF5 is a data software library, data management service and storage forhererogeneous data. Built in with fast \"I/O\" processing.</li>\n<li>storing scientific numerical data</li>\n</ul>\n<p>What is HDF5?</p>\n<ul>\n<li>A file specification and associated data model</li>\n<li>A standard library with API access for C++, Python, Java, etc.</li>\n<li>A software ecosystem consisting of client applications using HDF5 and analysis platforms like MATLAB, Python</li>\n</ul>","noteIndex":{"id":"wn8PE1RhG0znK1alrGFYv","title":"Root","desc":"","updated":1763992060664,"created":1631901573363,"custom":{"nav_order":0,"permalink":"/"},"fname":"root","type":"note","vault":{"fsPath":"vault"},"contentHash":"dc095b340c158394d643b84f8585ff0c","links":[],"anchors":{},"children":["dgcsvcwea8scgdegrk9tfni","xig93vo47ou1bkr7s4w1wb2","ro9bbyftsutm88mxw6r16p5","ypia1zmywsklpicmcgrzlz1","w7iitlako61ppm27mym400a","6bx5plramu4hksomqc1n55z","4nki3bedlvs3mnkixj3a07k","9r5ym61dkwap92fvbte1jkq","849u97nrsuyekmr4a1r92ux","2b5bwf46z6v132wu7xghvrp","dygp5h2vzw4mkromwmofynb","7h50s7ga5ziiyblmoctsqmw","pglaolxcge4xfvgoph3je89","uy9u1co5ih1fokind8tg0eq","jc23ggp8iiu92kpnzo721to","f1u2a47guuw70olv36bzf66","c1bs7wsjfbhb0zipaywqv1","2av385tcj2cbumxprsauff3","lw1b4r6ykimvj9208nkgzps"],"parent":null,"data":{},"body":"\nZdr bebce kp ;)\n\nThis is my knowledge base, additionally I keep [daily journal](https://docs.google.com/document/d/1m8Npu0-t8RweyKiHCjLL1PPDYzbebqm3OZDHH8IVsb8/edit?tab=t.rj0kvkrm7zpr)."},"collectionChildren":null,"customHeadContent":null,"config":{"version":5,"dev":{"enablePreviewV2":true},"commands":{"lookup":{"note":{"selectionMode":"extract","confirmVaultOnCreate":false,"leaveTrace":false,"bubbleUpCreateNew":true,"fuzzThreshold":0.2,"vaultSelectionModeOnCreate":"smart"}},"insertNote":{"initialValue":"templates"},"insertNoteLink":{"aliasMode":"none","enableMultiSelect":false},"insertNoteIndex":{"enableMarker":false},"randomNote":{},"copyNoteLink":{"aliasMode":"title"},"templateHierarchy":"template"},"workspace":{"vaults":[{"fsPath":"vault"}],"journal":{"dailyDomain":"daily","name":"journal","dateFormat":"y.MM.dd","addBehavior":"childOfDomain"},"scratch":{"name":"scratch","dateFormat":"y.MM.dd.HHmmss","addBehavior":"asOwnDomain"},"graph":{"zoomSpeed":1,"createStub":false},"enableAutoCreateOnDefinition":false,"enableXVaultWikiLink":false,"enableRemoteVaultInit":true,"workspaceVaultSyncMode":"noCommit","enableAutoFoldFrontmatter":true,"maxPreviewsCached":10,"maxNoteLength":204800,"task":{"name":"","dateFormat":"","addBehavior":"childOfCurrent","statusSymbols":{"":" ","wip":"w","done":"x","assigned":"a","moved":"m","blocked":"b","delegated":"l","dropped":"d","pending":"y"},"prioritySymbols":{"H":"high","M":"medium","L":"low"},"todoIntegration":false,"createTaskSelectionType":"selection2link","taskCompleteStatus":["done","x"]},"enableUserTags":true,"enableHashTags":true,"dendronVersion":"0.95.0","enableEditorDecorations":true,"enableFullHierarchyNoteTitle":false,"templateHierarchy":"template"},"preview":{"enableFMTitle":true,"enableNoteTitleForLink":true,"enablePrettyRefs":true,"enableKatex":true,"automaticallyShowPreview":false,"enableFrontmatterTags":true,"enableHashesForFMTags":false},"publishing":{"enableFMTitle":true,"enableNoteTitleForLink":true,"enablePrettyRefs":true,"enableKatex":true,"copyAssets":true,"siteHierarchies":["root"],"writeStubs":false,"siteRootDir":"docs","seo":{"title":"Dendron","description":"Personal knowledge space"},"github":{"enableEditLink":true,"editLinkText":"Edit this page on GitHub","editBranch":"main","editViewMode":"tree"},"enableSiteLastModified":true,"enableFrontmatterTags":true,"enableHashesForFMTags":false,"enableRandomlyColoredTags":true,"enableTaskNotes":true,"enablePrettyLinks":true,"searchMode":"lookup","assetsPrefix":"/dendron-wiki","siteUrl":"https://ngocuong0105.github.io","duplicateNoteBehavior":{"action":"useVault","payload":["vault"]},"theme":"light","templateVersion":"0.97.0","ga":{"tracking":"G-W5DRRLQ1N7"},"siteFaviconPath":"favicon.ico","siteIndex":"root"}}},"__N_SSG":true}